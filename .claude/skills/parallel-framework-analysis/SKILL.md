# /parallel-analysis - 并行Agent框架分析技能

## 触发命令
`/parallel-analysis [公司代码]`
`/parallel-analysis [多个公司代码]`

## 功能描述
利用Claude Code的Task Agent能力，并行执行多维度分析任务：
- 同时启动多个独立分析agent
- 各agent专注单一维度深度分析
- 协调agent汇总综合结论
- 大幅缩短复杂分析时间

## 并行分析架构

```
                    ┌─────────────────────┐
                    │   协调Agent (Main)   │
                    │  - 任务分发          │
                    │  - 进度监控          │
                    │  - 结果汇总          │
                    └──────────┬──────────┘
                               │
           ┌───────────────────┼───────────────────┐
           │                   │                   │
    ┌──────▼──────┐     ┌──────▼──────┐     ┌──────▼──────┐
    │  Agent 1    │     │  Agent 2    │     │  Agent 3    │
    │ 周期分析    │     │ 股权结构    │     │ 聪明钱追踪  │
    └──────┬──────┘     └──────┬──────┘     └──────┬──────┘
           │                   │                   │
    ┌──────▼──────┐     ┌──────▼──────┐     ┌──────▼──────┐
    │  Agent 4    │     │  Agent 5    │     │  汇总Agent  │
    │ 信号监控    │     │ 预测市场    │     │  综合报告   │
    └─────────────┘     └─────────────┘     └─────────────┘
```

## 执行流程

### Step 1: 并行任务规划
```yaml
输出格式:
  🚀 并行分析启动：[公司名称] ([代码])

  📊 并行任务分配：

  Agent 1: 行业周期分析 (Explore agent)
    - 目标: Stage定位 + 拐点概率
    - 预计时长: 15分钟
    - 独立运行: ✅

  Agent 2: 股权结构分析 (Explore agent)
    - 目标: 稀缺性倍数 + 控制权价值
    - 预计时长: 12分钟
    - 独立运行: ✅

  Agent 3: 聪明钱追踪 (Explore agent)
    - 目标: 机构持仓 + 投资逻辑
    - 预计时长: 15分钟
    - 独立运行: ✅

  Agent 4: 信号监控 (Explore agent)
    - 目标: 预警信号 + 触发条件
    - 预计时长: 10分钟
    - 独立运行: ✅

  Agent 5: 预测市场分析 (Explore agent)
    - 目标: 概率矩阵 + PPDA背离
    - 预计时长: 18分钟
    - 独立运行: ✅

  ⏱️ 顺序执行预计: 70分钟
  ⚡ 并行执行预计: 20分钟 (节省71%)

  ❓ 确认启动并行分析？
```

### Step 2: 并行Agent启动
```python
# Claude Code执行示例
Task(
    subagent_type="Explore",
    prompt="分析[公司]的行业周期位置，输出Stage定位和拐点概率",
    run_in_background=True
)

Task(
    subagent_type="Explore",
    prompt="分析[公司]的股权结构，计算稀缺性倍数",
    run_in_background=True
)

# 同时启动所有5个agent
```

### Step 3: 进度监控
```yaml
实时状态显示:
  📊 并行分析进度：

  Agent 1 [周期分析]   ████████░░ 80% - 发现Stage 2→3拐点
  Agent 2 [股权结构]   ██████████ 100% ✅ 完成
  Agent 3 [聪明钱]     ███████░░░ 70% - 巴菲特持仓分析中
  Agent 4 [信号监控]   ██████████ 100% ✅ 完成
  Agent 5 [预测市场]   █████░░░░░ 50% - PPDA计算中

  ⏱️ 已用时间: 12分钟
  📈 预计剩余: 5分钟
```

### Step 4: 结果汇总
```yaml
汇总流程:
  1. 等待所有agent完成
  2. 收集各agent输出
  3. 交叉验证一致性
  4. 识别分歧点
  5. 生成综合报告

输出格式:
  ✅ 并行分析完成！

  📊 各维度分析结果：

  【周期分析】
  - Stage: 2→3过渡期
  - 拐点概率: 78.4%
  - 时机判断: 偏早

  【股权结构】
  - 稀缺性倍数: 2.18x
  - 控制权价值: 高
  - 流动性约束: 中

  【聪明钱】
  - 机构共识: 强看多 (85%)
  - 巴菲特逻辑: AI基础设施必选
  - 信心等级: A级

  【信号监控】
  - 当前预警: 绿灯
  - 潜在触发: 3个
  - 最近风险: 低

  【预测市场】
  - PMSI指数: 76.4
  - 主要背离: 台海风险 (91.3%)
  - 套利机会: 存在

  🔍 一致性检查：
  ✅ 5个维度方向一致
  ⚠️ 估值分歧: 周期分析偏保守 vs 预测市场偏乐观

  📝 综合结论：
  [基于5维度汇总的投资建议]
```

## 并行分析场景

### 场景1: 单公司五引擎并行
```
/parallel-analysis NVDA
```
同时启动5个分析引擎，20分钟完成完整五引擎分析

### 场景2: 多公司对比分析
```
/parallel-analysis NVDA AMD INTC
```
每公司一个agent，并行分析后输出对比表格

### 场景3: 行业全景扫描
```
/parallel-analysis 半导体行业TOP5
```
自动识别行业TOP5公司，并行快速扫描

## 与阶段管理的配合

```yaml
大项目阶段中的并行优化:

阶段2 (数据雷达) - 可并行:
  - Agent A: 周期分析
  - Agent B: 财报数据
  - Agent C: 预测市场数据
  节省时间: 60%

阶段3 (深度分析) - 可并行:
  - Agent A: 护城河分析
  - Agent B: 估值建模
  - Agent C: 竞争对手分析
  节省时间: 50%
```

## 使用限制

```yaml
并行agent数量:
  推荐: 3-5个
  最大: 建议不超过5个
  原因: 太多并行会增加协调复杂度

适用场景:
  ✅ 独立维度分析 (互不依赖)
  ✅ 多公司对比 (相同框架)
  ✅ 数据收集 (不同数据源)

不适用场景:
  ❌ 有依赖关系的任务
  ❌ 需要前序结论的分析
  ❌ 简单单一任务
```

## 版本
v1.0 - 2026-02-06
