---
name: red-team-executor
description: Phase 4红队七问执行器 v1.0。确保对抗审查覆盖7个固定维度(承重墙/偏差/空头钢人/数据审计/黑天鹅/时间框架/替代解释)。自动生成承重墙脆弱度表和黑天鹅概率加权表。
---

# Phase 4 红队七问执行器 v1.0

> **核心职责**: 确保Phase 4对抗审查严格按照RT-1~RT-7结构执行，每个维度独立回答、量化优先、不可合并。

## 触发条件

Phase 4启动时自动调用。当检测到以下信号时执行:
- Phase 3已完成且通过质量门控
- 用户指令包含"Phase 4"/"红队"/"对抗审查"/"RT"
- orchestrator流程进入Phase 4阶段

## 执行流程

### Step 1: 读取前序产出

1. 读取所有Phase 1-3 staging文件: `reports/{TICKER}/staging/`
2. 读取shared_context.md获取DM锚点: `data/research/{TICKER}/shared_context.md`
3. 读取CQ注册表获取当前置信度: `reports/{TICKER}/data/cq_evolution.md`
4. 获取当前股价用于Reverse DCF隐含假设分析

### Step 2: RT-1 承重墙测试

**Prompt模板**:
```
分析当前股价${PRICE}的Reverse DCF隐含假设:
1. 列出所有承重墙(隐含增长率/利润率/年限/折现率)
2. 对每面墙评估:
   - 隐含值 vs 历史/行业参考
   - 脆弱度: 高(隐含超参考50%+) / 中(超10-50%) / 低(在范围内)
   - 若倒塌: 对估值的影响%
3. 识别"最脆弱的一面墙"
```

**输出格式 -- 承重墙脆弱度表**:

```markdown
| 承重墙(隐含假设) | 隐含值 | 历史/行业参考 | 脆弱度 | 若倒塌影响 |
|-----------------|:------:|:----------:|:-----:|:--------:|
| Revenue CAGR 5Y | X% | 行业中位Y% | 高/中/低 | -Z% |
| Operating Margin | X% | 历史均值Y% | 高/中/低 | -Z% |
| Terminal Growth | X% | GDP+通胀Y% | 高/中/低 | -Z% |
| WACC | X% | 同业均值Y% | 高/中/低 | -Z% |
| Capex/Revenue | X% | 历史均值Y% | 高/中/低 | -Z% |
```

**要求**: 至少5面承重墙，每面墙有明确的数据锚点(DM来源)。

### Step 3: RT-2 认知偏差审计

检查6种偏差，每种必须独立评估:

| 偏差类型 | 检查方法 | 判定标准 |
|---------|---------|---------|
| 锚定效应 | 是否过度依赖初始数据点(如IPO价/历史高点) | Phase 1-3中是否反复引用同一锚点 |
| 确认偏误 | 是否选择性引用支持论点的证据 | 看多vs看空证据数量比>3:1即触发 |
| 过度自信 | 置信度是否缺乏校准 | CQ置信度>70%且缺乏不确定性讨论 |
| 损失厌恶 | 是否回避讨论下行风险 | 下行情景描述<上行情景50% |
| 幸存者偏差 | 是否只看成功案例不看失败 | 类比公司是否包含失败案例 |
| 叙事偏差 | 是否构建了过于连贯的故事 | 叙事是否忽略矛盾数据点 |

**每种偏差输出**:
- 是否检测到: 是/否
- 在哪个判断上: [具体引用Phase 1-3中的段落]
- 校正后变化: [量化影响，如"校正后估值下调X%"]

### Step 4: RT-3 空头钢人

找**最强**的3条空头论证(有数据支撑):

**要求**:
- 每条必须让看多者"不舒服"
- 每条必须有≥1个硬数据支撑
- 每条必须说明"如果空头对了"的估值影响
- 排除已在Phase 3讨论过的弱空头论点

**格式**:
```markdown
### 空头论证 #N: [标题]

**核心论点**: [一句话]
**数据支撑**: [硬数据:] [来源]
**看多者反驳**: [当前分析中的反驳]
**反驳的弱点**: [反驳中最薄弱的环节]
**若空头正确**: 估值影响 -X%，目标价从$A降至$B
```

### Step 5: RT-4 数据质量审计

抽查≥10个核心数据点，按质量排序:

| 质量等级 | 来源类型 | 可靠度 |
|---------|---------|-------|
| A级 | SEC Filing (10-K/10-Q/8-K) | 极高 |
| B级 | 财报电话会议记录 | 高 |
| C级 | 卖方分析师估计 | 中 |
| D级 | 新闻报道/媒体引述 | 中低 |
| E级 | 行业传闻/未验证来源 | 低 |

**输出格式**:
```markdown
| # | 数据点 | 引用值 | 来源 | 质量等级 | 验证状态 |
|---|--------|:-----:|------|:-------:|:-------:|
| 1 | [数据] | [值] | [来源] | A/B/C/D/E | 已验证/待验证/存疑 |
```

**识别"数据最弱环"**: 指出整个分析中最依赖低质量数据的关键判断。

### Step 6: RT-5 黑天鹅压力测试

**输出格式 -- 黑天鹅概率加权表**:

```markdown
| # | 事件 | 独立概率 | 影响幅度 | 加权损失 | 时间窗口 | 早期信号 |
|---|------|:-------:|:-------:|:-------:|:-------:|---------|
| BS-1 | [具体事件] | X% | -Y% | -Z% | N年内 | [信号] |
| BS-2 | [具体事件] | X% | -Y% | -Z% | N年内 | [信号] |
| BS-3 | [具体事件] | X% | -Y% | -Z% | N年内 | [信号] |
```

**要求**:
- ≥3个事件
- 概率来源优先使用Polymarket(`polymarket_events`工具)
- 无Polymarket数据时用历史基准率(需标注[合理推断:])
- 加权损失 = 独立概率 x 影响幅度
- 累计加权损失 = 所有事件加权损失之和(需计算)

### Step 7: RT-6 时间框架挑战

**评估维度**:

1. **论文有效期**: 当前分析论文的合理有效期是多久?
2. **假设衰减时间线**:
   - 6个月后: 哪些假设可能过时?
   - 1年后: 哪些核心逻辑可能失效?
   - 3年后: 行业格局可能发生什么根本变化?
3. **催化剂日历对齐**: 已识别的催化剂是否支持论文时间框架?
4. **时间框架错配风险**: 论文隐含的投资周期与实际催化剂时间是否匹配?

### Step 8: RT-7 替代解释

对同样的数据找≥1个完全不同但合理的解释:

**格式**:
```markdown
### 替代解释 #N

**原始解释**: [Phase 1-3中的主流解释]
**同样数据**: [使用的具体数据点]
**替代解释**: [完全不同的合理解释]
**替代解释的含义**: [若替代解释正确，投资论文如何变化]
**区分信号**: [什么未来数据能区分两种解释]
```

**经典替代解释模式**:
- 收入增长 → 需求强劲 OR 渠道塞货?
- 利润率扩张 → 运营效率 OR 削减研发?
- 客户增长 → 产品吸引力 OR 补贴驱动?
- 市场份额增长 → 竞争优势 OR 价格战?

### Step 9: 汇总与CQ置信度调整

**CQ调整建议表**:
```markdown
| CQ# | P3置信度 | RT影响 | 建议P4置信度 | 调整理由 |
|:---:|:-------:|:-----:|:----------:|---------|
| CQ1 | X% | RT-1,RT-3 | Y% | [具体理由] |
| CQ2 | X% | RT-5 | Y% | [具体理由] |
```

**汇总指标**:
- 红队严重发现数(影响>10%估值的发现)
- CQ平均下调幅度
- 最脆弱CQ(下调最大)
- 最稳健CQ(未受影响或上调)

## 执行规则

1. **7问全部必答** -- 每个RT独立回答，不可合并，不可跳过
2. **每个≥200字** -- 低于200字的RT视为未完成
3. **量化优先** -- "校正后估值下调12%"而非"影响较大"
4. **数据锚定** -- 每个RT至少引用1个DM锚点或外部来源
5. **三层标注** -- 遵循[硬数据:]/[合理推断:]/[主观判断:]标注体系
6. **Mermaid图≥5张**:
   - 承重墙脆弱度可视化(RT-1)
   - 偏差检测矩阵(RT-2)
   - 黑天鹅影响雷达图(RT-5)
   - 时间框架衰减图(RT-6)
   - RT间协同影响矩阵(汇总)

## 输出

写入 `reports/{TICKER}/staging/S{N}_red_team_rt1_rt7.md`

文件头部格式:
```markdown
# Phase 4: 红队七问对抗审查 -- {TICKER}
> 执行日期: {DATE} | 股价: ${PRICE} | RT版本: v1.0

## 目录
- RT-1: 承重墙测试
- RT-2: 认知偏差审计
- RT-3: 空头钢人
- RT-4: 数据质量审计
- RT-5: 黑天鹅压力测试
- RT-6: 时间框架挑战
- RT-7: 替代解释
- 汇总: CQ置信度调整
```

## 质量门控 (QG-10 v10.0)

| 检查项 | 要求 | 严重度 |
|--------|------|:------:|
| RT-1~RT-7全部回答 | 7/7完成 | BLOCK |
| 每个RT≥200字 | 最短RT≥200字 | BLOCK |
| 承重墙脆弱度表存在 | 表格+≥5行 | BLOCK |
| 黑天鹅概率加权表≥3事件 | BS-1~BS-3+ | BLOCK |
| 替代解释≥1个 | 至少1个完整替代解释 | BLOCK |
| CQ调整建议表存在 | 覆盖所有CQ | WARN |
| Mermaid图≥5张 | 5张指定类型 | WARN |
| 三层标注密度≥15/万字 | 计算密度 | WARN |
| 空头论证有数据支撑 | 每条≥1个硬数据 | WARN |
| 数据质量审计≥10个数据点 | 抽查覆盖度 | WARN |

**BLOCK级未通过**: 必须修复后才能进入Phase 5
**WARN级未通过**: 记录但不阻断，Phase 5时关注

## 与其他skill的集成

- **输入源**: Phase 1-3 staging文件 + shared_context.md + CQ注册表
- **输出目标**: cq-lifecycle-tracker(CQ调整建议) + Phase 5汇总
- **数据工具**: `fmp_data`(验证财务数据) + `polymarket_events`(黑天鹅概率) + `baggers_summary`(基本面交叉验证)

---

*红队七问执行器 v1.0 -- 让对抗审查结构化、可追踪、不遗漏*
