# TSM (台积电) Deep Research v4.0 — 升级总规划

> **创建日期**: 2026-02-07
> **目标**: 全面重写TSM报告，应用AMD v3.1验证方法论 + Multi-Agent Team协作
> **当前版本**: v2.0 (99,670字符, 标注密度0.1/万 ← 不合格)
> **目标版本**: v4.0 (≥127,500字符, 标注密度≥15/万, Fast Gate 7/7通过)

---

## 1. 现状诊断

### TSM报告版本历史

| 版本 | 日期 | 字符数 | 标注数 | 密度(/万) | Fast Gate | 状态 |
|------|------|--------|--------|-----------|-----------|------|
| v2.0 Elite | 2026-01-29 | ~50K | ~0 | ~0 | ❌ G2 | 废弃 |
| v5.0 TopTier | 2026-02-03 | 103,078 | ~2 | ~0.02 | ❌ G2 | 废弃 |
| v6.0 L5 (6 Phase) | 2026-02-03 | ~120K | ~5 | ~0.04 | ❌ G2 | 废弃 |
| v9.0 Strategic | 2026-02-05 | 136,677 | ~2 | ~0.01 | ❌ G2 | 参考 |
| v10.0 PredMkt | 2026-02-05 | 38,394 | ~10 | ~2.6 | ❌ G2 | 参考 |
| **v2.0 DeepRes** | **2026-02-06** | **99,670** | **9** | **0.09** | **❌ G2** | **当前最新** |

### 关键质量差距 (TSM v2.0 vs AMD v3.1)

| 质量维度 | TSM v2.0 | AMD v3.1 | 差距 | 优先级 |
|---------|---------|---------|------|--------|
| 标注密度 | 0.09/万 | 16.3/万 | **181x** | 🔴 P0 |
| Kill Switch | ~5个(非结构化) | 17个(编号+阈值) | 12个 | 🔴 P0 |
| 可验证预测 | ~3个 | 20+个 | 17个 | 🔴 P0 |
| 看空论点 | ~2个(泛泛) | 8个(结构化) | 6个 | 🟡 P1 |
| Mermaid图表 | ~5个 | 15个 | 10个 | 🟡 P1 |
| 决策树 | 0 | 3个 | 3个 | 🟢 P2 |
| Fast Gate | ❌ G2失败 | ✅ 7/7通过 | — | 🔴 P0 |

### 可复用内容评估

TSM 849K字符历史数据中，以下内容数据质量好但缺标注，可作为v4.0的**数据骨架**:

| 来源 | 可复用内容 | 需要做的 |
|------|-----------|---------|
| v9.0 Strategic | 产业链映射、竞争格局、地缘分析框架 | 添加标注、更新数据 |
| v10.0 PredMkt | PPDA框架、预测市场方法论 | 扩展覆盖面、添加标注 |
| v2.0 Phase 1 | 公司画像基础、2nm技术分析 | 添加标注、深化分析 |
| v2.0 Phase 2 | 财务趋势框架、SOTP基础 | 添加标注、更新2025数据 |
| v2.0 Phase 3 | 五引擎框架、护城河分析 | 添加标注、量化升级 |

**复用策略**: 不是复制粘贴，而是**以旧版为数据参考，全部重写并添加标注**。

---

## 2. v4.0 目标规格

### 核心KPI

| 指标 | v4.0目标 | 对标AMD v3.1 |
|------|---------|-------------|
| 总字符数 | ≥130,000 (wc -m) | 90,413 (AMD用简化4P) |
| 标注密度 | ≥15/万字符 | 16.3/万 |
| 标注总数 | ≥195个 | 147个 |
| Kill Switch | ≥15个(编号KS-01~15+) | 17个 |
| 看空论点 | ≥8个(结构化) | 8个 |
| 可验证预测 | ≥20个 | 20+个 |
| Mermaid图表 | ≥15个 | 15个 |
| 决策树 | ≥3个 | 3个 |
| Fast Gate | 7/7通过 | 7/7通过 |
| 综合评分 | ≥85/100 | 70.3/100 |

### TSM特有分析要求 (AMD不需要的)

| 维度 | 原因 | 目标深度 |
|------|------|---------|
| **地缘政治风险** | 台海是全球半导体最大单点风险 | ≥8,000字符 + PPDA |
| **2nm/A16工艺** | 代工厂核心竞争力 | ≥5,000字符 + 技术路线图 |
| **CoWoS先进封装** | AI需求瓶颈 | ≥4,000字符 + 产能模型 |
| **客户集中度** | Apple/NVDA/AMD占收入>50% | ≥4,000字符 + 切换成本 |
| **海外扩产** | 亚利桑那/日本/德国 | ≥3,000字符 + 时间线 |
| **股权/ADR结构** | 外资持有限制+地缘溢价 | ≥3,000字符 |

---

## 3. Phase分解与执行计划

### 采用简化4-Phase路径 (AMD验证)

TSM不是首次覆盖（有849K历史数据），适用简化路径。

### Phase 0: 数据预取 + 市场辩论扫描 (自动执行)

**Agent Team配置**: 7个并行Agent

| Agent # | 任务 | 数据需求 | 字符目标 |
|---------|------|---------|---------|
| Agent 1 | TSM 2nm/A16/N3P技术路线图 | 良率、进度、客户采用、vs Intel 18A/三星2nm | 8K-12K |
| Agent 2 | CoWoS/SoIC先进封装 | 产能(2024-2027)、价格、客户分配、竞争者 | 6K-10K |
| Agent 3 | 地缘政治+供应链 | 台海概率、出口管制、海外fab进度、CHIPS Act | 8K-12K |
| Agent 4 | 财务数据 | 2023-2025季度营收/毛利率/CapEx/自由现金流/分红 | 6K-8K |
| Agent 5 | 客户分析+竞争格局 | Top 5客户份额、三星/Intel代工份额、SMIC进展 | 6K-10K |
| Agent 6 | 聪明钱+机构持仓 | 13F数据、ADR流动性、外资限额、大宗交易 | 5K-8K |
| Agent 7 | 预测市场+分析师共识 | Polymarket台海/AI、卖方目标价分布、EPS估计 | 5K-8K |

**市场辩论扫描**: 与Agent并行执行，识别TSM当前Top 10市场关注点。

**Phase 0 产出**: `data/research/TSM/` 目录下7个数据文件 + `shared_context.md` + `market_debates.md`

---

### Phase 1: 定位+生态+市场图谱 (1个会话)

**对应标准协议**: Phase 0.5 + Phase 1
**字符目标**: ≥25,000 (wc -m)
**标注目标**: ≥37个 (15/万)

**模块清单**:

| # | 模块 | 字符目标 | 核心内容 | Agent可分配 |
|---|------|---------|---------|------------|
| 1.1 | 公司全景画像 | 4,000 | 业务模型+历史+管理层(魏哲家评估) | ❌ 主Agent |
| 1.2 | 产业链生态映射 | 4,000 | 上游(ASML/应材)+下游(Apple/NVDA/AMD)+竞争者 | ✅ Agent A |
| 1.3 | 2nm/A16技术路线图 | 5,000 | 工艺节点演进+良率+时间线+vs竞争者 | ✅ Agent B |
| 1.4 | 预测市场环境 | 3,000 | 台海/AI/禁运概率矩阵 | ❌ 主Agent(引用P0数据) |
| 1.5 | 半导体周期初步定位 | 3,000 | P1-P5定位+6层雷达信号 | ❌ 主Agent |
| 1.6 | M14市场注意力雷达 | 3,000 | Top10维度+覆盖计划+CQ清单 | ❌ 主Agent |
| 1.7 | Hot-Patch (如有) | 3,000 | 市场辩论扫描发现的未覆盖热点 | ✅ Agent C |

**门控 QG-01~03**: 画像≥3K字 + 产业链≥10节点 + 预测市场≥8事件 + Top 10覆盖计划

---

### Phase 2: 财务+估值+周期 (1个会话)

**对应标准协议**: Phase 2
**字符目标**: ≥30,000 (wc -m)
**标注目标**: ≥45个 (15/万)

**模块清单**:

| # | 模块 | 字符目标 | 核心内容 | Agent可分配 |
|---|------|---------|---------|------------|
| 2.1 | 周期精确定位 | 5,000 | AI 4阶段+库存周期+CapEx周期叠加 | ❌ 主Agent |
| 2.2 | 5年财务趋势 | 6,000 | 收入/毛利/FCF/资产负债+同比分析 | ✅ Agent A |
| 2.3 | SOTP分部估值 | 5,000 | 逻辑/HPC/智能手机/IoT/汽车 分部 | ✅ Agent B |
| 2.4 | DCF估值 | 4,000 | 10年DCF+敏感性分析+WACC推导 | ✅ Agent C |
| 2.5 | 可比公司估值 | 3,000 | vs三星/Intel/ASML/SMIC倍数 | ✅ Agent B(并入) |
| 2.6 | 三情景矩阵 | 4,000 | Bull($250+)/Base($200-220)/Bear($140-160) | ❌ 主Agent |
| 2.7 | 资本配置分析 | 3,000 | CapEx ROI/R&D效率/分红策略 | ✅ Agent A(并入) |

**门控 QG-04~06**: 周期定位≥4信号 + SOTP覆盖≥90%营收 + 三估值偏离<20%

---

### Phase 3: 战略+引擎+AI评估 (1个会话)

**对应标准协议**: Phase 3 + Phase 3.5
**字符目标**: ≥35,000 (wc -m)
**标注目标**: ≥52个 (15/万)

**模块清单**:

| # | 模块 | 字符目标 | 核心内容 | Agent可分配 |
|---|------|---------|---------|------------|
| 3.1 | 护城河量化 | 5,000 | 技术壁垒+客户锁定+规模+专利 | ✅ Agent A |
| 3.2 | 技术替代威胁 | 4,000 | Intel 18A/三星GAA/RISC-V/chiplet | ✅ Agent B |
| 3.3 | CoWoS产能瓶颈 | 4,000 | 供需模型+价格趋势+客户分配 | ✅ Agent C |
| 3.4 | 地缘政治深度 | 8,000 | 台海情景+PPDA+海外扩产+CHIPS Act | ✅ Agent D |
| 3.5 | 五引擎协同分析 | 5,000 | 周期+股权+聪明钱+信号+预测市场 | ❌ 主Agent |
| 3.6 | PPDA背离分析 | 3,000 | ≥3个显著背离 + 套利机会 | ❌ 主Agent |
| 3.7 | M13 AI冲击矩阵 | 4,000 | 分部级AI评估(HPC/手机/IoT/汽车) | ✅ Agent E |
| 3.8 | L×S定位+AI调整估值 | 2,000 | 实施深度+AI溢价/折价 | ❌ 主Agent |

**门控 QG-07~09.5**: 护城河量化 + 五引擎各≥3K + PPDA≥3背离 + AI冲击≥90%营收

---

### Phase 4: 对抗审查+决策输出 (1个会话)

**对应标准协议**: Phase 4 + Phase 5
**字符目标**: ≥35,000 (wc -m)
**标注目标**: ≥28个 (8/万, Phase 4标准)

**模块清单**:

| # | 模块 | 字符目标 | 核心内容 | Agent可分配 |
|---|------|---------|---------|------------|
| 4.1 | 行为金融4项偏差 | 4,000 | 锚定/确认偏误/过度自信/损失厌恶 | ❌ 主Agent |
| 4.2 | 事实核查 | 4,000 | ≥12个核心数据点溯源 | ✅ Agent A |
| 4.3 | 看空等权重分析 | 6,000 | ≥8个结构化看空论点+钢人反驳 | ✅ Agent B |
| 4.4 | 反证挑战 | 3,000 | ×3条"如果完全错误" | ❌ 主Agent |
| 4.5 | Smart Money验证 | 3,000 | 机构持仓vs结论一致性 | ✅ Agent A(并入) |
| 4.6 | 极端压力测试 | 3,000 | SOTP极端+AI极端+台海极端 | ❌ 主Agent |
| 4.7 | 维度回检 | 2,000 | Top 10维度100%回应确认 | ❌ 主Agent |
| 4.8 | Kill Switch系统 | 4,000 | ≥15个编号触发条件(含台海/AI/技术) | ❌ 主Agent |
| 4.9 | 可验证预测清单 | 3,000 | ≥20个(概率+时间+触发) | ❌ 主Agent |
| 4.10 | 投资评级+仓位+日历 | 3,000 | 综合评分+90天行动清单 | ❌ 主Agent |

**门控 QG-10~12**: 偏差检查4/4 + 核查≥12点 + KS≥15 + 预测≥20 + Fast Gate通过

---

## 4. Agent Team 协作方案

### 会话级Agent分配总览

| Phase | 并行Agent数 | 主Agent负责 | SubAgent负责 | 预计总产出 |
|-------|-----------|------------|-------------|-----------|
| P0 | 7个 | 市场辩论扫描 | 7路数据预取 | 50K-70K原始数据 |
| P1 | 2-3个 | 画像+周期+M14 | 产业链+技术+Hot-Patch | ≥25K |
| P2 | 2-3个 | 周期+情景+整合 | 财务+估值 | ≥30K |
| P3 | 4-5个 | 五引擎+PPDA+AI整合 | 护城河+技术+CoWoS+地缘+AI矩阵 | ≥35K |
| P4 | 1-2个 | 偏差+反证+KS+评级 | 事实核查+看空分析 | ≥35K |

### Agent Prompt模板 (基于AMD最佳实践)

每个SubAgent prompt必须包含:
```
## 任务: [具体模块名]
## CQ关联: 回答Core Question #X: "[具体问题]"
## 数据需求:
- [指标1]: [来源建议]
- [指标2]: [来源建议]
...
## Phase前序发现:
- [P0/P1关键结论1]
- [P0/P1关键结论2]
## 输出要求:
- 字符目标: X,000-Y,000字符
- 标注格式: [A: 来源, 日期] 或 [B: 来源, 日期]
- 标注密度: ≥15个/万字符
- Mermaid图: ≥N个
- 表格: ≥M张
## 禁止事项:
- 不写"众所周知"等模糊表述
- 不编造数据
- 无数据时标注"该指标未获取到公开数据"
```

---

## 5. 时间线

| 会话 | Phase | 预计时长 | 交付物 |
|------|-------|---------|--------|
| **Session 0** (本次) | 规划 | 1小时 | 本规划文档 + 框架升级 + Agent基础设施 |
| **Session 1** | Phase 0 | 30分钟 | 7个数据文件 + shared_context.md + market_debates.md |
| **Session 2** | Phase 1 | 2-3小时 | TSM_v4.0_Phase1.md (≥25K字符, Fast Gate通过) |
| **Session 3** | Phase 2 | 2-3小时 | TSM_v4.0_Phase2.md (≥30K字符, Fast Gate通过) |
| **Session 4** | Phase 3 | 3-4小时 | TSM_v4.0_Phase3.md (≥35K字符, Fast Gate通过) |
| **Session 5** | Phase 4 | 3-4小时 | TSM_v4.0_Phase4.md (≥35K字符, Fast Gate通过) |
| **Session 6** | 整合 | 1小时 | TSM_v4.0_Complete.md (≥130K, 7/7 Fast Gate) |

**总预计**: 6个会话, 12-16小时

---

## 6. 风险与缓解

| 风险 | 概率 | 影响 | 缓解 |
|------|------|------|------|
| SubAgent返回低质量数据 | 中 | 标注密度不达标 | 详细prompt + 主Agent补充标注 |
| 单Phase字符不足 | 中 | Fast Gate G1失败 | 预留10%缓冲 + 扩展分析深度 |
| 预测市场数据不可用 | 低 | PPDA分析受限 | 标注"无覆盖" + 用替代信号 |
| 台海新闻事件影响 | 低 | 需紧急更新地缘分析 | 设计模块化结构便于更新 |
| 会话上下文溢出 | 高 | Phase产出被截断 | 每模块完成立即写入文件 |

---

## 7. 质量保障

### 每Phase完成后检查清单

```bash
# 1. Fast Gate
bash tests/research_fast.sh reports/TSM_v4.0_Phase{N}.md {min_chars} 3

# 2. 手动抽检
- [ ] 标注密度 ≥15/万 (Phase 4: ≥8/万)
- [ ] 每个Core Question有≥1个模块回答
- [ ] 禁止词零出现
- [ ] Mermaid图表语法正确
- [ ] 免责声明存在

# 3. Git commit
git add reports/TSM_v4.0_Phase{N}.md
git commit -m "feat(半导体): TSM v4.0 Phase {N} - [阶段名] 完成"

# 4. STATUS.md更新
```

### 最终整合检查

```bash
# 合并所有Phase
bash tests/research_fast.sh reports/TSM_v4.0_Complete.md 130000 3
# 期望: 7/7 PASS, 0 errors, ≤2 warnings
```

---

## 8. 与AMD v3.1的关键差异

| 维度 | AMD v3.1 | TSM v4.0 | 原因 |
|------|---------|---------|------|
| 字符目标 | 90K (4Phase简化) | 130K (4Phase但更深) | TSM地缘+技术维度更多 |
| 地缘分析深度 | 2K (芯片禁运) | 8K+ (台海+海外fab+禁运) | TSM是地缘风险最集中的公司 |
| 技术路线图 | 3K (Zen5/MI350) | 5K+ (2nm/A16/CoWoS/SoIC) | 代工厂技术是核心壁垒 |
| 客户分析 | 2K (PC/服务器分部) | 4K+ (Apple/NVDA/AMD依赖度) | 客户集中度风险更高 |
| PPDA背离 | 3个 | ≥4个 (台海背离是独特的) | 预测市场对台海有丰富数据 |
| Phase 0 Agent数 | 9个 | 7个 (更聚焦) | 减少冗余，提高每Agent产出 |

---

**文件路径**: `reports/TSM_v4.0_Upgrade_Master_Plan.md`
**下次执行**: Session 1 → Phase 0 数据预取
**前置条件**: 本规划commit后，下次会话直接执行 Phase 0
