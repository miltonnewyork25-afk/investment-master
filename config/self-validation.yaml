# 投资大师 - 自我验证与质量控制系统
# Self-Validation & Quality Control System v1.0
# 多视角检验 + 偏误审计 + 输出标准 + 迭代协议

version: "1.0.0"
created: "2026-01-24"

# ============================================================
# 第一部分: 多虚拟视角验证系统 (Multi-Perspective Validation)
# 每次输出必须通过至少3个虚拟视角的交叉检验
# ============================================================

virtual_perspectives:
  perspective_1_bull_advocate:
    role: "极度看多者"
    question: "如果我坚信这个股票/行业必涨，我会如何解读这些数据？"
    bias_to_check: "bearish_bias, pessimism_bias"
    validation_output: "bull_case_strength: 0-100"
    criteria:
      - "被忽视的正面信号有哪些？"
      - "历史类似情况中上涨的概率？"
      - "最乐观但合理的情景是什么？"

  perspective_2_bear_advocate:
    role: "极度看空者"
    question: "如果我坚信这个股票/行业必跌，我会如何解读这些数据？"
    bias_to_check: "bullish_bias, optimism_bias"
    validation_output: "bear_case_strength: 0-100"
    criteria:
      - "被忽视的风险信号有哪些？"
      - "历史类似情况中下跌的概率？"
      - "最悲观但合理的情景是什么？"

  perspective_3_naive_outsider:
    role: "完全不了解背景的局外人"
    question: "如果我第一次看到这个分析，有什么不明白或不信任的？"
    bias_to_check: "curse_of_knowledge, insider_bias"
    validation_output: "clarity_score: 0-100"
    criteria:
      - "术语是否需要解释？"
      - "逻辑链条是否有跳跃？"
      - "结论是否不言自明或需要信仰飞跃？"

  perspective_4_quantitative_auditor:
    role: "纯数据审计员"
    question: "如果我只看数字，不看任何叙事，数据支持什么结论？"
    bias_to_check: "narrative_fallacy, authority_bias"
    validation_output: "data_support_score: 0-100"
    criteria:
      - "每个主张是否有对应数据？"
      - "数据来源是否独立可验证？"
      - "统计显著性是否足够？"
      - "是否有cherry-picking嫌疑？"

  perspective_5_adversarial_critic:
    role: "恶意攻击者/做空者"
    question: "如果我想证明这个分析完全错误，最强的反驳是什么？"
    bias_to_check: "overconfidence, blind_spots"
    validation_output: "vulnerability_score: 0-100"
    criteria:
      - "最薄弱的假设是哪个？"
      - "哪个数据点如果错了，整个结论就崩塌？"
      - "是否有过度拟合历史数据的风险？"
      - "极端事件(黑天鹅)会如何打破这个框架？"

  resolution_rule:
    description: "多视角共识规则"
    rules:
      - "5个视角中4+个一致 → 高信心输出 (confidence = 0.9)"
      - "5个视角中3个一致 → 中信心输出 (confidence = 0.7)"
      - "5个视角中2-3个一致 → 低信心，需要更多数据"
      - "5个视角无共识 → 不输出结论，标记为'insufficient_evidence'"

# ============================================================
# 第二部分: 偏误审计协议 (Bias Audit Protocol)
# 每次分析输出前的强制检查清单
# ============================================================

bias_audit_protocol:
  pre_analysis_check:
    description: "分析开始前的自我校准"
    steps:
      - "记录当前情绪状态 (neutral/optimistic/pessimistic/uncertain)"
      - "记录已有的先验观点 (prior_belief)"
      - "设定: 什么证据能改变我的观点？(falsification_criteria)"
      - "确认: 我是否在寻找特定答案？(goal_awareness)"

  during_analysis_check:
    description: "分析过程中的偏误检测"
    triggers:
      - trigger: "发现第3个支持结论的证据但0个反对证据"
        action: "暂停，主动搜索反向证据"
        bias: "confirmation_bias"

      - trigger: "引用'这次不一样'或'前所未有'"
        action: "找到历史类比，量化'不同'的程度"
        bias: "narrative_fallacy"

      - trigger: "使用'显然'、'毫无疑问'、'必然'等绝对词"
        action: "替换为概率表述"
        bias: "overconfidence"

      - trigger: "结论与最近新闻方向高度一致"
        action: "检查3个月前的同类分析是否得出相同结论"
        bias: "recency_bias"

      - trigger: "分析结论恰好支持已有仓位"
        action: "用'空仓重新评估'视角重做分析"
        bias: "endowment_effect"

  post_analysis_check:
    description: "分析完成后的质量验证"
    mandatory_questions:
      - "如果这个结论错了，最可能的原因是什么？"
      - "需要什么新信息才能推翻这个结论？"
      - "这个结论在什么时间范围内有效？"
      - "信心水平(0-100)与历史同类分析的准确率匹配吗？"
      - "是否有遗漏的关键变量？"

# ============================================================
# 第三部分: 输出质量标准 (Output Quality Standards)
# ============================================================

output_standards:
  investment_analysis:
    required_components:
      - component: "数据基础"
        standard: "至少3个独立数据源支持核心结论"
        validation: "data_sources.count >= 3"

      - component: "概率表述"
        standard: "所有预测使用概率区间，非点估计"
        validation: "contains_probability_range = True"
        example: "12个月回报预期: +40% to +80% (基于历史5个类似周期)"

      - component: "时间范围"
        standard: "每个预测明确有效期"
        validation: "time_horizon_defined = True"
        example: "此信号在3-12个月时间范围内有效"

      - component: "风险标注"
        standard: "每个买入信号附带止损条件"
        validation: "stop_loss_condition_defined = True"
        example: "如果评分降至40以下持续4周，重新评估"

      - component: "偏误声明"
        standard: "标注分析可能受到的偏误影响"
        validation: "bias_disclosure_present = True"
        example: "注意: 本分析可能受近期LRCX涨幅的锚定效应影响"

      - component: "反向场景"
        standard: "描述如果结论错误会是什么情况"
        validation: "counter_scenario_present = True"

  marketing_content:
    required_components:
      - component: "心理原则标注"
        standard: "每条内容标注使用的心理原则"
        validation: "psychology_principles_tagged = True"

      - component: "伦理检查"
        standard: "通过Brenncke Line测试"
        validation: "brenncke_test_pass = True"
        test: "充分知情的用户会感谢这个推送吗？"

      - component: "价值优先"
        standard: "信息价值 > 营销目的"
        validation: "value_to_reader > conversion_intent"

      - component: "真实性"
        standard: "所有数据主张可验证"
        validation: "all_claims_verifiable = True"

      - component: "退出路径"
        standard: "用户可随时退出/取消"
        validation: "exit_option_visible = True"

# ============================================================
# 第四部分: 迭代净化协议 (Iteration & Purification Protocol)
# ============================================================

iteration_protocol:
  atomic_unit_definition:
    description: "最小可迭代单元定义"
    levels:
      - level: "信号级"
        unit: "单一评分指标 (如PE阈值)"
        iteration_cycle: "每季度回测验证"
        success_metric: "预测准确率 > 基准"

      - level: "规则级"
        unit: "单条偏误修正规则"
        iteration_cycle: "每月效果评估"
        success_metric: "决策质量提升(回顾性评分)"

      - level: "框架级"
        unit: "完整评分框架"
        iteration_cycle: "每半年大版本更新"
        success_metric: "整体回测准确率维持/提升"

      - level: "内容级"
        unit: "单条推文/单期周报"
        iteration_cycle: "每次发布后72小时评估"
        success_metric: "互动率 > 历史均值"

      - level: "心理级"
        unit: "单个心理原则应用"
        iteration_cycle: "每10次使用后统计"
        success_metric: "转化率 > 对照组"

  purification_rules:
    description: "自我净化 = 识别并移除无效/有害规则"
    process:
      - step: "检测"
        action: "每条规则跟踪应用次数和成功率"
        trigger: "成功率连续3次低于50%"

      - step: "隔离"
        action: "将疑似无效规则标记为'待验证'"
        duration: "隔离观察2个迭代周期"

      - step: "验证"
        action: "在控制条件下对比有无此规则的表现"
        method: "A/B对比或历史回溯"

      - step: "决策"
        action: |
          if 验证后仍无效: 移除规则
          if 条件性有效: 添加触发条件
          if 误判(实际有效): 恢复并增加权重

      - step: "记录"
        action: "所有移除/修改记录在EVOLUTION.md"
        format: "日期 | 规则ID | 操作 | 原因 | 证据"

  anti_drift_mechanism:
    description: "防止方向偏移的锚定机制"
    core_principles:
      - "逆周期投资: 底部买入，顶部卖出"
      - "数据驱动: 叙事服从数据，非相反"
      - "边际思维: 关注变化率，非绝对水平"
      - "MECE完整: 分析覆盖所有互斥且穷举的维度"
      - "伦理底线: 教育 > 操纵, 透明 > 隐瞒"
    drift_detection:
      - "每月对照核心原则检查所有新增规则"
      - "如果新规则与核心原则矛盾 → 标记冲突"
      - "冲突解决: 核心原则优先，除非有压倒性证据"

# ============================================================
# 第五部分: 网络监控与学习协议 (Internet Monitoring Protocol)
# ============================================================

monitoring_protocol:
  research_domains:
    behavioral_finance:
      sources:
        - "SSRN behavioral finance papers (weekly check)"
        - "NBER working papers (monthly)"
        - "Journal of Behavioral Finance (quarterly)"
        - "Journal of Finance - behavioral section"
      keywords: ["cognitive bias", "market anomaly", "investor behavior", "prospect theory"]
      action: "提取可编码的新规则，添加到偏误修正层"

    marketing_psychology:
      sources:
        - "Journal of Consumer Psychology"
        - "Marketing Science Institute working papers"
        - "Harvard Business Review - behavioral marketing"
        - "Nudge Unit (BIT) publications"
      keywords: ["persuasion", "nudge", "choice architecture", "behavioral design"]
      action: "提取新的内容创作规则"

    market_cases:
      sources:
        - "Bloomberg/Reuters market commentary"
        - "Fed/ECB meeting minutes (behavioral language)"
        - "Earnings call transcripts (sentiment analysis)"
        - "Reddit/Twitter sentiment extremes"
      keywords: ["panic", "euphoria", "capitulation", "FOMO", "bubble"]
      action: "记录实时群体心理案例，验证/更新群体心理模型"

    neuroeconomics:
      sources:
        - "Journal of Neuroscience (decision-making section)"
        - "Nature Human Behaviour"
        - "PNAS behavioral papers"
      keywords: ["dopamine", "reward prediction", "loss processing", "risk neural"]
      action: "更新神经经济学模型参数"

  case_collection:
    description: "实时案例收集与分类"
    template:
      date: "YYYY-MM-DD"
      market_event: "描述"
      crowd_behavior: "群体做了什么"
      psychology_explanation: "用哪个偏误/理论解释"
      framework_prediction: "我们的框架会给出什么建议"
      actual_outcome: "实际结果"
      lesson: "学到什么"
      rule_update: "是否需要更新规则"

# ============================================================
# 第六部分: 边际效益评估 (Marginal Return Assessment)
# ============================================================

marginal_assessment:
  description: "评估每次迭代的边际收益是否递减"
  metrics:
    accuracy_marginal:
      current_baseline: "100% (164 data points)"
      question: "新增规则能否在更多数据点上保持100%？"
      diminishing_returns_signal: "准确率已为100%，新增规则的边际贡献在于扩展覆盖范围而非提升精度"

    content_marginal:
      metrics: ["engagement_rate", "subscriber_growth", "share_rate"]
      question: "每条新内容的边际互动率是否递减？"
      action_if_diminishing: "改变内容类型/渠道，非增加同类内容量"

    complexity_marginal:
      question: "新增规则的复杂度是否超过其贡献？"
      rule: "if complexity_cost > accuracy_gain: reject_rule"
      occam_razor: "两个等效模型，选择更简单的"

    user_value_marginal:
      question: "新功能对用户的边际价值是否递减？"
      rule: "优先开发80%用户需要的功能，非20%用户的高级需求"

  resource_allocation:
    description: "基于边际收益分配迭代资源"
    priority_formula: "priority = marginal_value / marginal_effort"
    rules:
      - "边际收益最高的原子单元优先迭代"
      - "边际收益为0或负的单元暂停迭代"
      - "每个迭代周期至少评估1次所有单元的边际收益"
