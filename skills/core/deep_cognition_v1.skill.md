# Deep Cognition Skill v1.3

> **Skill ID**: `core.deep_cognition_v1`
> **版本**: 1.3.0
> **创建日期**: 2026-01-28
> **更新日期**: 2026-01-28
> **测试验证**: Tesla, Apple, Google, Amazon
> **v1.1核心改进**: 双向搜索、生态系统分析、对称认知方法、平衡检查
> **v1.2核心改进**: 用户声音挖掘（弥补AI无法线下调研的不足）
> **v1.3核心改进**: 期权估值、隐藏痕迹挖掘、顶级投资者学习、技术架构深挖、估值体系升级

---

## 概述

Deep Cognition Skill 是一个分层的深度思考框架，整合了10种AI原生认知方法和多种提问模式，通过实战测试验证有效性，并根据不同场景自动调整方法权重。

---

## v1.3 新增核心模块总览

```yaml
v1.3_new_modules:
  1_option_valuation: "期权业务识别与估值"
  2_hidden_traces: "隐藏痕迹挖掘（按公司类型）"
  3_investor_learning: "顶级投资者/分析师框架学习"
  4_tech_architecture: "核心技术架构深度解构"
  5_valuation_upgrade: "估值体系升级（反推+敏感性+期权+共识）"

enforcement:
  - 每个模块有强制输出格式
  - 缺失任一模块 = 报告不合格
  - 断言检查自动验证
```

---

## v1.3 模块1：期权业务识别与估值

### 设计原理

```yaml
problem: |
  Tesla分析中使用了期权估值（FSD、Optimus、能源），产生了独特洞察
  但Google分析中完全遗漏了期权业务（Waymo、DeepMind、Verily）
  原因：没有强制要求识别和估值"彩票型业务"

solution: |
  强制识别公司中的"期权业务"（低概率高回报的业务）
  用期权思维估值，而非传统DCF
```

### 执行协议

```yaml
option_business_identification:
  触发条件: 所有科技公司、生态型公司、有研发投入的公司

  step_1_识别期权业务:
    问: "公司有哪些'低概率但成功后回报巨大'的业务？"
    识别标准:
      - 当前收入贡献<5%
      - 技术或市场存在重大不确定性
      - 成功后潜在市场规模>$100B
      - 公司持续投入（证明有期权价值）

    示例:
      Tesla: [FSD自动驾驶, Optimus机器人, 能源业务]
      Google: [Waymo自动驾驶, DeepMind AGI, Verily医疗, Wing无人机]
      Amazon: [Kuiper卫星, 医疗业务, Zoox自动驾驶]
      Apple: [汽车项目, AR/VR生态, 金融服务]

  step_2_期权参数估算:
    对每个期权业务:
      - 标的资产价值(S): 成功后的潜在市值贡献
      - 执行价格(K): 实现需要的累计投资
      - 波动率(σ): 行业/技术的不确定性（高波动性=高期权价值）
      - 到期时间(T): 预计成熟/清晰的时间点
      - 成功概率: 技术+商业+竞争三重概率

  step_3_期权估值:
    简化估值方法: |
      期权价值 = 成功概率 × (成功后市值贡献 - 累计投资)

      注意：失败概率不是完全损失，因为：
      1. 技术可能转移到其他业务
      2. 人才和专利有残值
      3. 战略价值（阻止竞争对手）

    输出表格: |
      ## 期权业务估值

      | 业务 | 成功概率 | 成功后价值 | 累计投资 | 期权价值 | 隐含市值 |
      |------|---------|-----------|---------|---------|---------|
      | {业务1} | {X}% | ${Y}B | ${Z}B | ${A}B | 当前${B}B |
      | {业务2} | ... | ... | ... | ... | ... |

      **期权业务总价值**: ${total}B
      **占当前市值比例**: {X}%
      **市场定价是否合理**: {高估/低估/合理}
```

---

## v1.3 模块2：隐藏痕迹挖掘

### 设计原理

```yaml
problem: |
  Tesla分析中尝试抓取充电桩数据来推断实际销量/使用率
  这种"从公开数据推断非公开信息"的能力非常有价值
  但Google分析中完全没有尝试类似方法

solution: |
  按公司类型定义"隐藏痕迹"挖掘模板
  强制执行至少3种隐藏痕迹搜索
```

### 公司类型→隐藏痕迹映射

```yaml
hidden_traces_by_company_type:

  科技平台公司:
    示例: [Google, Meta, Amazon, Microsoft]
    隐藏痕迹来源:
      - App Store/Play Store排名和评分变化
      - 第三方流量监测（SimilarWeb, Sensor Tower）
      - 开发者社区活跃度（GitHub stars, npm downloads）
      - 招聘信息（LinkedIn职位数量和类型）
      - 云服务定价变化（暗示成本结构）
      - API定价和限制变化（暗示战略优先级）
      - 专利申请数量和领域（暗示研发方向）

    搜索模板:
      - "{product} app ranking trend 2026"
      - "{company} developer survey satisfaction"
      - "{company} hiring trend linkedin {month} 2026"
      - "{cloud_service} pricing history changes"
      - "{company} patent filings AI {year}"
      - "SimilarWeb {product} traffic trend"
      - "GitHub {company} repository stars trend"

  汽车/制造公司:
    示例: [Tesla, BYD, Toyota, Rivian]
    隐藏痕迹来源:
      - 充电桩使用数据（充电网络运营商报告）
      - 车辆注册数据（各国交通部门）
      - 二手车价格走势（暗示品牌价值）
      - 保险数据（事故率、维修成本）
      - 供应商财报（暗示订单量）
      - 工厂卫星图像（产能利用率）
      - 职位招聘（产能扩张计划）

    搜索模板:
      - "{brand} vehicle registration {country} {month} 2026"
      - "{brand} used car price trend"
      - "{brand} insurance claim rate data"
      - "{supplier} earnings {company} mentioned"
      - "{company} factory satellite image expansion"

  消费品牌公司:
    示例: [Apple, Nike, Starbucks, LVMH]
    隐藏痕迹来源:
      - 门店客流监测（Placer.ai等）
      - 社交媒体提及量和情感（Brandwatch）
      - 转售市场价格（StockX、得物）
      - 信用卡消费数据（Second Measure）
      - 供应商产能利用率
      - 员工满意度（Glassdoor评分趋势）

    搜索模板:
      - "{brand} store traffic trend Placer.ai"
      - "{product} resale price StockX trend"
      - "{brand} social media sentiment {month} 2026"
      - "{brand} supplier order cut news"
      - "{company} Glassdoor rating trend"

  半导体公司:
    示例: [NVIDIA, AMD, ASML, TSMC, LRCX]
    隐藏痕迹来源:
      - 晶圆厂产能利用率（DigiTimes、SEMI）
      - 设备交付周期（暗示需求）
      - 下游客户资本开支计划
      - 光刻机出货量（ASML季度报告）
      - 硅片出货量（SEMI数据）
      - 二手设备价格（暗示需求周期）

    搜索模板:
      - "{fab} utilization rate {month} 2026"
      - "{equipment} lead time trend 2026"
      - "SEMI silicon wafer shipment {quarter} 2026"
      - "{customer} capex guidance 2026 fab"
      - "used semiconductor equipment price trend"

  SaaS/云服务公司:
    示例: [Salesforce, Snowflake, Datadog]
    隐藏痕迹来源:
      - 第三方用量监测（Built With, Wappalyzer）
      - 开发者论坛活跃度
      - 竞品切换率（G2 Crowd评论）
      - 企业IT预算调查
      - 技术会议赞助和演讲

    搜索模板:
      - "BuiltWith {product} usage trend 2026"
      - "{product} vs {competitor} migration reddit"
      - "Gartner IT spending forecast 2026 {category}"
      - "{product} conference attendance {year}"
```

### 执行协议

```yaml
hidden_traces_execution:
  触发条件: 所有/deep分析
  最低要求: 至少尝试3种隐藏痕迹搜索

  step_1_识别公司类型:
    根据上述映射确定公司类型

  step_2_选择搜索模板:
    从该类型的搜索模板中选择≥3个
    优先选择：最可能有数据、最能验证核心论点的

  step_3_执行搜索并记录:
    即使搜索失败（无数据），也要记录尝试

  输出格式: |
    ## 隐藏痕迹挖掘（v1.3新增）

    | 痕迹类型 | 搜索内容 | 发现 | 洞察 |
    |---------|---------|------|------|
    | {类型1} | "{搜索词}" | {数据/无数据} | {洞察} |
    | {类型2} | "{搜索词}" | {数据/无数据} | {洞察} |
    | {类型3} | "{搜索词}" | {数据/无数据} | {洞察} |

    **关键发现**: {最重要的隐藏痕迹洞察}
    **验证论点**: 该发现{支持/反驳}核心投资论点
```

---

## v1.3 模块3：顶级投资者/分析师框架学习

### 设计原理

```yaml
problem: |
  之前的分析只是罗列分析师观点和目标价
  没有真正"解构"他们的思维框架
  也没有找到他们的盲区和超越点

solution: |
  强制执行分析师框架解构流程
  必须回答4个核心问题
  必须找到超越点
```

### 执行协议

```yaml
analyst_learning_execution:
  触发条件: 所有/deep分析
  最低要求: 解构≥3位顶级分析师/投资者

  step_1_识别顶级分析师:
    搜索: "{company} best analyst coverage recommendation"
    筛选标准:
      - 长期跟踪该公司（≥3年）
      - 有独特框架（不是只跟风）
      - 过往预测准确率高
      - 来自不同机构（多元视角）

    投资者搜索:
      - "{company} activist investor position"
      - "{company} hedge fund ownership 13F"
      - "{company} Berkshire Buffett comment"

  step_2_框架解构（每位分析师必答4问）:
    Q1_核心框架: "他看这家公司的核心逻辑是什么？（不是结论，是方法）"
    Q2_关键假设: "他的框架基于什么假设？"
    Q3_失效条件: "什么情况下他的假设会失效？"
    Q4_盲区识别: "他忽略了什么重要因素？"

  step_3_超越点识别:
    问: "我比顶级分析师多知道什么？我的独特视角是什么？"
    要求:
      - 必须找到至少1个分析师忽略的重要因素
      - 可以是：数据、时效性、跨行业视角、技术理解

  输出格式: |
    ## 顶级分析师框架解构（v1.3强化）

    ### 分析师1: {姓名} ({机构})

    **核心框架**: {他如何看待这家公司}
    **关键假设**:
    - 假设1: {假设}
    - 假设2: {假设}
    **失效条件**: 如果{条件}发生，其框架失效
    **盲区**: {他忽略了什么}

    ### 分析师2: ...
    ### 分析师3: ...

    ### 顶级投资者视角

    | 投资者 | 持仓动作 | 核心逻辑 | 时间 |
    |--------|---------|---------|------|
    | {投资者1} | {买入/卖出/持有} | {逻辑} | {时间} |
    | ... | ... | ... | ... |

    ### 我的超越点

    **分析师共同盲区**: {他们都忽略了什么}
    **我的独特洞察**: {我看到了什么他们没看到的}
    **验证方法**: {如何验证我的洞察是否正确}
```

---

## v1.3 模块4：核心技术架构深度解构

### 设计原理

```yaml
problem: |
  科技公司分析往往技术架构分析太浅
  只说"有AI能力"，不深入到架构层
  无法判断技术优势的可持续性

solution: |
  强制进行技术架构深度分析
  从底层（芯片/基础设施）到上层（应用/产品）
```

### 执行协议

```yaml
tech_architecture_execution:
  触发条件: 科技公司、有自研技术的公司

  step_1_技术栈分层分析:
    层级:
      L0_基础设施: "数据中心、芯片、网络"
      L1_平台层: "云服务、AI框架、开发工具"
      L2_能力层: "算法、模型、核心技术"
      L3_应用层: "产品、服务、用户界面"

    对每层回答:
      - 自研 vs 外购？
      - 竞争优势在哪层？
      - 哪层最难被复制？

  step_2_关键技术深挖:
    识别3个最关键的技术组件，深入分析:
      - 技术原理（用非专业人能理解的语言）
      - 为什么难以复制（资金？人才？数据？时间？）
      - 领先程度（vs 最强竞争对手）
      - 演进路径（下一代技术方向）

  step_3_技术护城河评估:
    问: "如果竞争对手今天开始复制，需要多久？需要多少资源？"
    量化:
      - 时间壁垒：X年
      - 资金壁垒：$Y B
      - 人才壁垒：Z人顶级工程师
      - 数据壁垒：需要X TB独特数据

  输出格式: |
    ## 核心技术架构分析（v1.3新增）

    ### 技术栈分层

    ```
    L3 应用层   : {产品列表}
           ↑
    L2 能力层   : {核心算法/模型}
           ↑
    L1 平台层   : {云服务/框架}
           ↑
    L0 基础设施 : {芯片/数据中心}
    ```

    | 层级 | 关键组件 | 自研/外购 | 竞争优势 |
    |------|---------|----------|---------|
    | L0 | {组件} | {自研/外购} | {强/中/弱} |
    | L1 | {组件} | {自研/外购} | {强/中/弱} |
    | L2 | {组件} | {自研/外购} | {强/中/弱} |
    | L3 | {组件} | {自研/外购} | {强/中/弱} |

    **最核心技术壁垒所在层**: {层级}

    ### 关键技术深挖

    #### 技术1: {名称}
    - **原理**: {非专业人能理解的解释}
    - **难以复制原因**: {资金/人才/数据/时间}
    - **vs 竞争对手**: 领先{X}年/{落后X年/持平}
    - **下一代方向**: {技术演进路径}

    #### 技术2: ...
    #### 技术3: ...

    ### 技术护城河量化

    | 壁垒类型 | 复制所需 | 评估 |
    |---------|---------|------|
    | 时间壁垒 | {X}年 | {高/中/低} |
    | 资金壁垒 | ${Y}B | {高/中/低} |
    | 人才壁垒 | {Z}人 | {高/中/低} |
    | 数据壁垒 | {描述} | {高/中/低} |

    **技术护城河综合评分**: {1-10}/10
    **最大技术风险**: {描述}
```

---

## v1.3 模块5：估值体系升级

### 设计原理

```yaml
problem: |
  之前的估值分析太简单：
  - 只用一种方法（PE或DCF）
  - 没有反推当前隐含假设
  - 没有敏感性分析
  - 期权业务没有单独估值
  - 与市场共识的差距没有解释

solution: |
  升级为完整估值体系：
  1. 反推估值（当前市值隐含什么？）
  2. 正向估值（SOTP多情景）
  3. 期权估值（彩票型业务）
  4. 敏感性分析
  5. 共识对比
```

### 执行协议

```yaml
valuation_upgrade_execution:
  触发条件: 所有/deep分析

  step_1_反推估值:
    目的: 理解市场当前定价隐含的假设
    方法:
      - 基于当前市值和PE，反推需要的增长率
      - 基于当前市值和DCF，反推需要的假设组合

    输出: |
      ### 反推估值：市场在假设什么？

      当前市值: ${X}B
      当前PE: {Y}x

      **隐含假设1（增长路径）**:
      要justify当前估值，需要未来5年CAGR={Z}%
      历史CAGR={A}%，隐含假设是{加速/减速/持平}
      合理性评估: {合理/过高/过低}

      **隐含假设2（利润率路径）**:
      要justify当前估值，需要利润率提升到{X}%
      当前利润率={Y}%，需要提升{Z}pp
      合理性评估: {合理/过高/过低}

      **市场定价结论**: 市场{高估/低估/合理}

  step_2_正向估值_SOTP:
    方法: 分部估值，多情景概率加权

    输出: |
      ### SOTP估值

      | 业务 | 估值方法 | 熊市 | 基准 | 牛市 |
      |------|---------|------|------|------|
      | {业务1} | {PE/EV-S} | ${X}B | ${Y}B | ${Z}B |
      | {业务2} | {PE/EV-S} | ... | ... | ... |
      | 期权业务 | 期权模型 | $0 | ... | ... |
      | 减：净债务 | | ... | ... | ... |
      | **总计** | | ${bear}B | ${base}B | ${bull}B |

      **情景概率**:
      - 熊市: {X}% → 目标价${bear_price}
      - 基准: {Y}% → 目标价${base_price}
      - 牛市: {Z}% → 目标价${bull_price}

      **概率加权目标价**: ${weighted_price}

  step_3_期权业务单独估值:
    引用模块1的期权估值结果

  step_4_敏感性分析:
    选择3个最敏感变量

    输出: |
      ### 敏感性分析

      | 变量 | 基准假设 | -20% | +20% | 股价影响 |
      |------|---------|------|------|---------|
      | {变量1} | {基准} | ${X} | ${Y} | {最敏感} |
      | {变量2} | {基准} | ${X} | ${Y} | |
      | {变量3} | {基准} | ${X} | ${Y} | |

      **最敏感变量**: {变量名}
      **监控建议**: {如何跟踪这个变量}

  step_5_共识对比:
    搜索市场共识目标价，与自己的估值对比

    输出: |
      ### 与市场共识对比

      | 来源 | 目标价 | 评级 |
      |------|--------|------|
      | 本报告 | ${my_price} | {rating} |
      | 华尔街共识 | ${consensus} | |
      | 最高目标价 | ${high} | {analyst} |
      | 最低目标价 | ${low} | {analyst} |

      **我与共识差异**: {X}%
      **差异解释**: {为什么我与共识不同}

  final_output: |
    ### 估值综合结论

    | 估值方法 | 结果 | 权重 |
    |---------|------|------|
    | 反推估值 | 市场{高估/低估} | 参考 |
    | SOTP概率加权 | ${X} | 70% |
    | 期权业务 | ${Y} | 20% |
    | 可比公司 | ${Z} | 10% |
    | **综合目标价** | **${final}** | |

    **评级**: {Buy/Hold/Sell}
    **当前价**: ${current}
    **上行空间**: {X}%
    **下行风险**: {Y}%
    **风险收益比**: {ratio}

    **Kill Switch**: 如果{条件}发生，重新评估
```

---

## 触发方式

```
/scan {ticker}    → Layer 0: 快速扫描（5分钟）
/analyze {ticker} → Layer 1: 标准分析（30分钟）
/deep {ticker}    → Layer 2: 深度分析（2小时）
```

---

## Layer 0: 快速扫描模式

### 触发: `/scan {ticker}`

### 方法组合

| 顺序 | 方法 | 权重 | 耗时 | 输出 |
|------|------|------|------|------|
| 1 | 压缩挑战 | 30% | 30秒 | 10字本质描述 |
| 2 | 矛盾引爆 | 40% | 2分钟 | 核心矛盾+解释 |
| 3 | 梯度聚焦 | 30% | 2分钟 | 关键变量排序 |

### 执行协议

```yaml
step_1_压缩挑战:
  指令: "用10个字说清{company}的本质"
  验证:
    - 字数≤10
    - 能区分于其他公司
    - 揭示真实商业模式
  失败处理: 如果无法压缩到10字，说明尚未理解本质，需要先做基础研究

  输出格式: |
    ## 本质压缩
    **{company}**: "{10字描述}"
    揭示: {这个压缩揭示了什么}

step_2_矛盾引爆:
  指令: "找到{company}最明显的矛盾：A是真的，但B也是真的，如何解释？"
  要求:
    - 矛盾必须是真实存在的，不是人造的
    - 解释必须到达非显而易见的层面
    - 解释必须有投资含义

  输出格式: |
    ## 核心矛盾
    **矛盾**: {A} vs {B}
    **解释**: {为什么两者同时为真}
    **洞察**: {这个矛盾揭示的非显而易见的真相}
    **投资含义**: {应该如何行动}

step_3_梯度聚焦:
  指令: "计算∂Value/∂Variable，找出最敏感的3个变量"
  要求:
    - 量化每个变量的敏感度
    - 排序从高到低
    - 给出研究时间分配建议

  输出格式: |
    ## 梯度图
    | 变量 | 敏感度 | 研究权重 |
    |------|--------|---------|
    | {var1} | 每变化1%→股价变化X% | {weight}% |
    | {var2} | 每变化1%→股价变化X% | {weight}% |
    | {var3} | 每变化1%→股价变化X% | {weight}% |

    **研究重点**: 把{weight1}%的时间花在{var1}上
```

### Layer 0 输出模板

```markdown
# {Company} 快速扫描

## 1. 本质压缩（10字）
**{Company}**: "{压缩结果}"
→ 揭示: {洞察}

## 2. 核心矛盾
**矛盾**: {A} vs {B}
**解释**: {解释}
**投资含义**: {含义}

## 3. 梯度聚焦
| 变量 | 敏感度 | 研究权重 |
|------|--------|---------|
| {var1} | {sensitivity1} | {weight1}% |
| {var2} | {sensitivity2} | {weight2}% |
| {var3} | {sensitivity3} | {weight3}% |

**结论**: {一句话总结}

---
*扫描时间: {timestamp}*
*方法: 压缩(30%) + 矛盾(40%) + 梯度(30%)*
```

---

## Layer 1: 标准分析模式

### 触发: `/analyze {ticker}`

### 方法组合

| 顺序 | 方法 | 权重 | 耗时 | 输出 |
|------|------|------|------|------|
| 1 | 压缩挑战 | 15% | 30秒 | 10字本质 |
| 2 | 矛盾引爆 | 20% | 3分钟 | 核心矛盾 |
| 3 | 梯度聚焦 | 20% | 3分钟 | 关键变量 |
| 4 | 负空间扫描 | 15% | 5分钟 | 隐藏信息 |
| 5 | 对抗测试 | 15% | 5分钟 | 最强反驳 |
| 6 | 跨域类比 | 15% | 5分钟 | 新视角 |

### 执行协议

```yaml
step_1_压缩挑战:
  # 同Layer 0

step_2_矛盾引爆:
  # 同Layer 0

step_3_梯度聚焦:
  # 同Layer 0

step_4_负空间扫描:
  指令: "列出{company}财报/公开信息中刻意没提的5件事"
  要求:
    - 必须是"应该提但没提"的信息
    - 分析为什么没提（对股价不利？）
    - 评估每个负空间的重要性

  输出格式: |
    ## 负空间扫描
    | 没提的信息 | 可能原因 | 重要性 |
    |-----------|---------|-------|
    | {info1} | {reason1} | 高/中/低 |
    | {info2} | {reason2} | 高/中/低 |
    | {info3} | {reason3} | 高/中/低 |
    | {info4} | {reason4} | 高/中/低 |
    | {info5} | {reason5} | 高/中/低 |

    **关键负空间**: {最重要的那个}
    **投资含义**: {应该自己做什么分析}

step_5_对抗测试:
  指令: "给出'{company}是好投资'的最强反驳，然后反驳它"
  要求:
    - 最强反驳必须是"钢人论证"（不是稻草人）
    - 反驳的反驳必须有数据支撑
    - 最终给出净结论

  输出格式: |
    ## 对抗测试

    ### 最强反驳（钢人论证）
    "{完整的反对论点}"

    ### 反驳这个反驳
    "{反驳论点}"

    ### 净结论
    **下行风险**: {X}%
    **上行空间**: {Y}%
    **风险收益比**: {ratio}

step_6_跨域类比:
  指令: "用{最佳领域}的语言重新描述{company}"
  领域选择规则:
    成熟平台公司: 生物学-生态系统
    技术转型公司: 物理学-相变
    多业务耦合公司: 系统动力学-飞轮
    周期性公司: 历史模式
    颠覆者: TRIZ原理

  输出格式: |
    ## 跨域类比: {领域}

    **类比**: {company} = {类比描述}

    **映射关系**:
    - {源概念1} → {目标概念1}
    - {源概念2} → {目标概念2}
    - {源概念3} → {目标概念3}

    **类比预测**: {基于类比的预测}
    **投资含义**: {投资行动}
```

### Layer 1 输出模板

```markdown
# {Company} 标准分析

## 1. 本质压缩
**{Company}**: "{10字描述}"

## 2. 核心矛盾
**矛盾**: {A} vs {B}
**解释**: {解释}
**洞察**: {洞察}

## 3. 梯度聚焦
| 变量 | 敏感度 | 研究权重 |
|------|--------|---------|
| {var1} | {sensitivity1} | {weight1}% |
| {var2} | {sensitivity2} | {weight2}% |
| {var3} | {sensitivity3} | {weight3}% |

## 4. 负空间扫描
| 没提的信息 | 可能原因 | 重要性 |
|-----------|---------|-------|
| {info1} | {reason1} | {importance1} |
| ... | ... | ... |

**关键负空间**: {最重要的}

## 5. 对抗测试
- **最强反驳**: {反驳}
- **反驳的反驳**: {反反驳}
- **净结论**: 下行{X}% vs 上行{Y}%

## 6. 跨域类比: {领域}
**{Company}** = {类比描述}
**类比预测**: {预测}

---

## 综合结论
**评级**: {Buy/Hold/Sell}
**核心逻辑**: {一句话}
**关键监控**: {最重要的变量}

---
*分析时间: {timestamp}*
*方法权重: 压缩(15%) + 矛盾(20%) + 梯度(20%) + 负空间(15%) + 对抗(15%) + 跨域(15%)*
```

---

## Layer 2: 深度分析模式

### 触发: `/deep {ticker}`

### 方法组合（v1.3更新）

| 阶段 | 方法 | 权重 | 输出 |
|------|------|------|------|
| **前置** | 双向平衡搜索 | 必须 | 威胁+优势+时效性 |
| **前置** | 第一性原理三问 | 必须 | 存在性/不可替代性/终局 |
| **前置** | 7 Powers护城河 | 必须 | 护城河验证表 |
| **前置** | 优势清单+生态系统 | 必须 | 5类优势+生态图 |
| 1 | 压缩挑战 | 6% | 10字本质 |
| 2 | 矛盾引爆 | 10% | 核心矛盾 |
| 3 | 梯度聚焦 | 10% | 关键变量 |
| 4 | 负空间扫描 | 8% | 隐藏信息 |
| 5 | 对抗测试 | 8% | 多空论点 |
| 6 | 跨域类比 | 8% | 新视角 |
| 7 | 反事实模拟 | 8% | 风险量化 |
| 8 | 边界探测 | 6% | 失效/加深条件 |
| 9 | 不变量搜索 | 4% | 本质特质 |
| 10 | 元递归 | 4% | 偏见检查 |
| **v1.2** | 用户声音挖掘 | 必须 | 正面+负面声音 |
| **v1.3** | 期权业务估值 | 必须 | 彩票型业务估值 |
| **v1.3** | 隐藏痕迹挖掘 | 必须 | ≥3种痕迹 |
| **v1.3** | 分析师框架解构 | 必须 | ≥3位分析师 |
| **v1.3** | 技术架构深挖 | 科技公司必须 | 4层技术栈 |
| **v1.3** | 估值体系升级 | 必须 | 5维度估值 |
| **后置** | 创新方法尝试 | 必须 | ≥3种非常规方法 |
| **后置** | 平衡检查 | 必须 | 多空平衡验证 |
| **后置** | Depth Index自测 | 必须 | DI评分≥70 |

### 执行协议

```yaml
# ========== 前置阶段（必须在任何分析之前完成） ==========

# ===== v1.1 新增：双向平衡搜索 =====
phase_0_balanced_search:
  执行条件: 在任何分析之前，必须完成双向搜索
  设计原理: |
    v1.0问题：搜索偏向威胁/风险，遗漏公司优势
    v1.1修复：强制双向搜索，确保多空视角平衡

  threat_searches:
    描述: "做空视角搜索"
    必须执行:
      - "{company} bear case risk threat 2026"
      - "{company} competition disruption challenge"
      - "{company} regulatory antitrust lawsuit"
      - "{company} market share loss decline"

  advantage_searches:
    描述: "做多视角搜索（v1.1新增）"
    必须执行:
      - "{company} competitive advantage moat infrastructure"
      - "{company} cost advantage vs competitors benchmark"
      - "{company} technology leadership innovation 2026"
      - "{company} exclusive data asset proprietary"
      - "{company} product ecosystem synergy integration"
      - "{company} undervalued underappreciated hidden"

  recency_searches:
    描述: "时效性搜索（v1.1新增）"
    必须执行:
      - "{company} {current_month} 2026 news announcement"
      - "{company} {key_product} latest review benchmark comparison"
      - "{company} earnings call transcript latest"

  # ===== v1.2 新增：用户声音挖掘 =====
  user_voice_searches:
    描述: "用户真实反馈搜索（v1.2新增）"
    设计原理: |
      AI无法线下调研和体验产品，但可以：
      1. 大量搜索用户反馈（好评、差评、使用细节）
      2. 拼接这些"声音碎片"构建产品真实画像
      3. 这种能力可以超越人类（人类不可能读完那么多评论）

    必须执行:
      # 正面反馈搜索
      - "{product} review amazing best love 2026 reddit"
      - "{product} vs {competitor} better why user experience"
      - "{product} switched from {competitor} why worth it"

      # 负面反馈搜索
      - "{product} problems issues frustrating disappointed 2026"
      - "{product} vs {competitor} worse limitations"
      - "{product} cancelled switched away why"

      # 细节挖掘搜索
      - "{product} hidden feature underrated tip"
      - "{product} real world use case workflow"
      - "{product} professional developer enterprise usage"

      # 社区情绪搜索
      - "{product} reddit community opinion 2026"
      - "{product} twitter sentiment reaction"
      - "{product} hacker news discussion"

    输出要求: |
      ## 用户声音拼图（v1.2新增）

      ### 正面声音（{X}条）
      | 来源 | 用户反馈摘要 | 揭示的优势 |
      |------|-------------|-----------|
      | Reddit/r/xxx | "{引用}" | {优势} |
      | Twitter | "{引用}" | {优势} |
      | ... | ... | ... |

      ### 负面声音（{Y}条）
      | 来源 | 用户反馈摘要 | 揭示的问题 |
      |------|-------------|-----------|
      | Reddit/r/xxx | "{引用}" | {问题} |
      | ... | ... | ... |

      ### 声音拼图洞察
      - 用户最常提到的优势：{列表}
      - 用户最常抱怨的问题：{列表}
      - 与竞品对比的共识：{列表}
      - 专业用户 vs 普通用户的差异：{列表}

  输出要求: |
    必须在报告中展示：
    - 威胁搜索发现：{X}个风险点
    - 优势搜索发现：{Y}个优势点
    - 最新动态：{Z}条近期消息
    - 用户声音：正面{A}条，负面{B}条

    ⚠️ 如果优势搜索数量<威胁搜索数量×0.5，触发偏见警告
    ⚠️ 如果用户声音搜索<10条，触发调研不足警告

phase_0_first_principles:
  执行条件: 在调用任何API或搜索之前

  Q1_存在性:
    问: "这家公司为什么存在？它解决了什么人类根本需求？"
    要求:
      - 不能用"提供产品/服务"
      - 必须到达人类需求本质
      - ≥300字

  Q2_不可替代性:
    问: "如果这家公司明天消失，世界会具体损失什么？"
    要求:
      - 列出3-5个具体损失
      - 不能泛泛而谈
      - ≥300字

  Q3_终局:
    问: "这个行业的终局是什么？这家公司在终局中的位置？"
    要求:
      - 描述10-20年后的行业形态
      - 公司的可能位置
      - ≥300字

phase_0_7powers:
  执行条件: 第一性原理三问完成后

  验证表格:
    | Power | 有/无 | 强度(1-10) | 趋势 | 具体证据 |
    |-------|------|-----------|------|---------|
    | 规模经济 | | | | |
    | 网络效应 | | | | |
    | 反向定位 | | | | |
    | 转换成本 | | | | |
    | 品牌 | | | | |
    | 垄断资源 | | | | |
    | 流程优势 | | | | |

  动态分析:
    - 过去5年护城河加深还是变浅？
    - 未来5年呢？

# ===== v1.1 新增：强制优势清单 =====
phase_0_advantage_list:
  执行条件: 双向搜索完成后
  设计原理: |
    v1.0问题：只列出数据，不主动分析竞争优势
    v1.1修复：强制输出结构化优势清单

  必须输出表格: |
    ## 核心竞争优势清单

    | 优势类型 | 具体内容 | 量化指标 | vs主要竞争对手 | 来源 |
    |---------|---------|---------|---------------|------|
    | 成本优势 | {描述} | {X}% 成本优势 | vs {竞争对手} | [来源] |
    | 技术优势 | {描述} | {领先程度} | vs {竞争对手} | [来源] |
    | 数据优势 | {描述} | {数据规模/独占性} | vs {竞争对手} | [来源] |
    | 分发优势 | {描述} | {渠道触达} | vs {竞争对手} | [来源] |
    | 生态优势 | {描述} | {协同效应} | vs {竞争对手} | [来源] |

  验证规则:
    - 每个优势必须有量化指标（不能只说"强"）
    - 每个优势必须有vs竞争对手的对比
    - 至少识别3个优势类型

# ===== v1.1 新增：生态系统分析（替代简单产品矩阵） =====
phase_0_ecosystem_analysis:
  执行条件: 优势清单完成后
  设计原理: |
    v1.0问题：产品矩阵只列收入占比，忽略产品间的技术/数据协同
    v1.1修复：用生态系统视角分析产品关系

  分析维度:
    数据流分析:
      问: "数据如何在产品间流动？哪个产品是数据源头？"
      示例: "YouTube视频 → Veo模型训练 → Gemini视频理解"

    技术栈共享:
      问: "哪些底层技术被多个产品共享？"
      示例: "TPU → 搜索/广告/云/AI研究 全部受益"

    独占资源识别:
      问: "什么资源是竞争对手无法获得的？"
      示例: "20B YouTube视频、10年搜索日志、DeepMind人才"

    分发渠道映射:
      问: "产品如何互相分发？"
      示例: "Chrome/Android/Search → 新产品的0成本分发"

  必须输出: |
    ## 生态系统分析图

    ```
    [数据源] ──→ [AI训练] ──→ [产品应用] ──→ [分发渠道]
       │              │              │              │
       ▼              ▼              ▼              ▼
    {具体}        {具体}        {具体}        {具体}
    ```

    **关键独占资源**: {列表}
    **竞争对手无法复制的环节**: {列表}
    **生态系统飞轮效应**: {描述}

# ========== 核心分析阶段（10种方法） ==========

step_1_压缩挑战:
  # 同Layer 0/1

step_2_矛盾引爆:
  # 同Layer 0/1

step_3_梯度聚焦:
  # 同Layer 0/1

step_4_负空间扫描:
  # 同Layer 1

step_5_对抗测试:
  # v1.1 升级：双向对抗测试（原版只做空，现在多空平衡）
  指令: "分别给出最强做空论点和最强做多论点"

  bear_case:
    问: "'{company}是坏投资'的最强论点是什么？"
    要求:
      - 必须是钢人论证（最强反对意见）
      - 必须有数据支撑
      - 必须说明触发条件

  bull_case:
    问: "'{company}是被低估的好投资'的最强论点是什么？"
    要求:
      - 必须找到市场忽略的价值
      - 必须有数据支撑
      - 必须说明催化剂

  输出格式: |
    ## 双向对抗测试

    ### 🐻 最强做空论点
    **核心论点**: {论点}
    **数据支撑**: {数据}
    **触发条件**: 如果{条件}发生，论点成立
    **概率评估**: {X}%

    ### 🐂 最强做多论点
    **核心论点**: {论点}
    **数据支撑**: {数据}
    **催化剂**: {催化剂}
    **概率评估**: {Y}%

    ### ⚖️ 净评估
    **下行风险**: {X}%
    **上行空间**: {Y}%
    **风险收益比**: {ratio}
    **当前市场定价**: 偏向{多/空}

step_6_跨域类比:
  # 同Layer 1，但要求≥2个领域

step_7_反事实模拟:
  指令: "模拟3个关键反事实场景"
  要求:
    - 选择最重要的3个风险/机会
    - 量化每个场景的财务影响
    - 计算概率加权影响

  输出格式: |
    ## 反事实模拟

    ### 场景1: {场景描述}
    - 条件: {触发条件}
    - 财务影响: {具体数字}
    - 股价影响: {百分比}
    - 概率: {X}%

    ### 场景2: ...
    ### 场景3: ...

    **概率加权影响**: {加权计算结果}

step_8_边界探测:
  # v1.1 升级：双向边界探测（原版只探测失效，现在也探测加深）
  指令: "列出护城河失效条件AND加深条件"

  failure_conditions:
    问: "什么条件下护城河会失效？"
    要求:
      - 列出所有可能导致护城河失效的条件
      - 评估每个条件的概率

  strengthening_conditions:
    问: "什么条件下护城河会加深？"
    要求:
      - 列出可能导致护城河加深的条件
      - 评估每个条件的概率

  输出格式: |
    ## 边界条件分析（双向）

    ### 护城河失效条件
    | 条件 | 描述 | 单独概率 |
    |------|------|---------|
    | 条件1 | {描述} | {X}% |
    | 条件2 | {描述} | {Y}% |

    **护城河彻底失效概率**: {联合概率}%

    ### 护城河加深条件（v1.1新增）
    | 条件 | 描述 | 单独概率 |
    |------|------|---------|
    | 条件1 | {描述} | {X}% |
    | 条件2 | {描述} | {Y}% |

    **护城河显著加深概率**: {联合概率}%

    ### 净评估
    加深概率({A}%) vs 失效概率({B}%)
    趋势判断: {护城河在加深/变浅}

step_9_不变量搜索:
  指令: "识别{company}的不变量（无论环境如何变化都保持的特质）"
  要求:
    - 通过极端场景测试识别不变量
    - 区分"结构性"和"周期性"特质

  输出格式: |
    ## 不变量分析

    **真正的不变量（核心能力）**:
    1. {能力1}
    2. {能力2}
    3. {能力3}

    **可变量（会随环境变化）**:
    1. {特质1}
    2. {特质2}

    **投资含义**: 短期关注{可变量}，长期关注{不变量}

step_10_元递归:
  指令: "检查分析过程中的偏见和盲区"
  要求:
    - 识别预设偏见
    - 识别改变结论的条件
    - 识别最可能的错误来源

  输出格式: |
    ## 元认知检查

    **我的预设偏见**: {偏见描述}
    **改变结论的条件**: {条件}
    **最可能的错误来源**: {错误来源}
    **对冲措施**: {如何对冲这个偏见}

# ========== 后置阶段 ==========

phase_final_innovation:
  执行条件: 核心分析完成后
  要求: 必须尝试≥3种非常规分析方法

  方法选项:
    - 反推估值: 当前市值隐含了什么假设？
    - 期权定价: 把某业务当期权估值
    - 用户价值法: 用户数×终身价值=应得市值？
    - 边际分析: 某变量变化10%，结果如何？
    - 情景模拟: 竞争对手做到X，市值变多少？
    - 供应链反推: 从供应商数据推断公司状况

  输出格式: |
    ## 创新方法尝试

    ### 方法1: {方法名}
    **过程**: {尝试过程}
    **结果**: {结果，即使失败也记录}
    **洞察**: {产生的洞察}

    ### 方法2: ...
    ### 方法3: ...

phase_final_depth_index:
  执行条件: 所有分析完成后
  要求: 必须计算Depth Index

  评分表:
    | 维度 | 权重 | 得分 | 加权分 |
    |------|------|------|--------|
    | D1 第一性原理 | 15% | /10 | |
    | D2 护城河深度 | 15% | /10 | |
    | D3 产品矩阵 | 10% | /10 | |
    | D4 竞争格局 | 10% | /10 | |
    | D5 分析师超越 | 10% | /10 | |
    | D6 创新方法 | 10% | /10 | |
    | D7 跨域类比 | 10% | /10 | |
    | D8 反常识洞察 | 10% | /10 | |
    | D9 数据溯源 | 5% | /10 | |
    | D10 估值逻辑 | 5% | /10 | |
    | **总计** | 100% | - | **DI = ?** |

  评级标准:
    DI ≥ 85: 优秀（可输出）
    DI 70-84: 合格（可输出）
    DI < 70: 不合格（必须返工）
```

### Layer 2 输出模板（v1.3 更新）

```markdown
# {Company} 深度研究报告

**报告日期**: {date}
**数据截止**: {data_date}
**Depth Index**: {DI}/100
**框架版本**: Deep Cognition Skill v1.3

---

## 第〇部分：核心竞争优势清单

| 优势类型 | 具体内容 | 量化指标 | vs主要竞争对手 | 来源 |
|---------|---------|---------|---------------|------|
| 成本优势 | {描述} | {指标} | vs {竞争对手} | [来源] |
| 技术优势 | {描述} | {指标} | vs {竞争对手} | [来源] |
| 数据优势 | {描述} | {指标} | vs {竞争对手} | [来源] |
| 分发优势 | {描述} | {指标} | vs {竞争对手} | [来源] |
| 生态优势 | {描述} | {指标} | vs {竞争对手} | [来源] |

### 生态系统分析图
```
[数据源] ──→ [AI训练] ──→ [产品应用] ──→ [分发渠道]
    │              │              │              │
    ▼              ▼              ▼              ▼
{具体}         {具体}         {具体}         {具体}
```

**关键独占资源**: {列表}
**竞争对手无法复制的环节**: {列表}

---

## 第一部分：第一性原理

### 1.1 存在性问题
{300字回答}

### 1.2 不可替代性问题
{300字回答}

### 1.3 终局问题
{300字回答}

---

## 第二部分：护城河分析

### 2.1 七种竞争优势验证

| Power | 有/无 | 强度 | 趋势 | 证据 |
|-------|------|------|------|------|
| 规模经济 | {Y/N} | {1-10} | {加深/变浅} | {证据} |
| 网络效应 | {Y/N} | {1-10} | {加深/变浅} | {证据} |
| 反向定位 | {Y/N} | {1-10} | {加深/变浅} | {证据} |
| 转换成本 | {Y/N} | {1-10} | {加深/变浅} | {证据} |
| 品牌 | {Y/N} | {1-10} | {加深/变浅} | {证据} |
| 垄断资源 | {Y/N} | {1-10} | {加深/变浅} | {证据} |
| 流程优势 | {Y/N} | {1-10} | {加深/变浅} | {证据} |

### 2.2 护城河动态
- **过去5年**: {加深/变浅}，因为{原因}
- **未来5年**: {预测}，因为{原因}

---

## 第三部分：深度认知分析

### 3.1 本质压缩
**{Company}**: "{10字描述}"

### 3.2 核心矛盾 [矛盾引爆]
{矛盾分析}

### 3.3 关键变量 [梯度聚焦]
{梯度分析}

### 3.4 隐藏信息 [负空间扫描]
{负空间分析}

### 3.5 多空论点 [双向对抗测试]
{做空论点+做多论点}

### 3.6 跨域视角 [跨域类比]
{类比分析}

### 3.7 风险量化 [反事实模拟]
{反事实分析}

### 3.8 边界条件 [双向边界探测]
{失效条件+加深条件}

### 3.9 不变本质 [不变量搜索]
{不变量分析}

### 3.10 偏见检查 [元递归]
{元认知分析}

---

## 第四部分：用户声音拼图（v1.2新增）

### 正面声音
| 来源 | 用户反馈摘要 | 揭示的优势 |
|------|-------------|-----------|
| {来源} | "{引用}" | {优势} |

### 负面声音
| 来源 | 用户反馈摘要 | 揭示的问题 |
|------|-------------|-----------|
| {来源} | "{引用}" | {问题} |

### 声音拼图洞察
{综合分析}

---

## 第五部分：v1.3深度模块

### 5.1 期权业务估值

| 业务 | 成功概率 | 成功后价值 | 累计投资 | 期权价值 |
|------|---------|-----------|---------|---------|
| {业务1} | {X}% | ${Y}B | ${Z}B | ${A}B |
| ... | ... | ... | ... | ... |

**期权业务总价值**: ${total}B
**市场定价是否合理**: {高估/低估/合理}

### 5.2 隐藏痕迹挖掘

| 痕迹类型 | 搜索内容 | 发现 | 洞察 |
|---------|---------|------|------|
| {类型1} | "{搜索词}" | {数据} | {洞察} |
| ... | ... | ... | ... |

**关键发现**: {最重要的隐藏痕迹洞察}

### 5.3 分析师框架解构

#### 分析师1: {姓名} ({机构})
- **核心框架**: {框架}
- **关键假设**: {假设}
- **失效条件**: {条件}
- **盲区**: {盲区}

#### 分析师2/3: ...

**我的超越点**: {独特洞察}

### 5.4 技术架构分析（科技公司）

| 层级 | 关键组件 | 自研/外购 | 竞争优势 |
|------|---------|----------|---------|
| L0 基础设施 | {组件} | {自研/外购} | {强/中/弱} |
| L1 平台层 | {组件} | {自研/外购} | {强/中/弱} |
| L2 能力层 | {组件} | {自研/外购} | {强/中/弱} |
| L3 应用层 | {组件} | {自研/外购} | {强/中/弱} |

**技术护城河综合评分**: {1-10}/10

---

## 第六部分：估值体系

### 6.1 反推估值：市场在假设什么？
- 隐含增长率: {X}%
- 隐含利润率: {Y}%
- 合理性评估: {合理/过高/过低}

### 6.2 SOTP估值

| 业务 | 估值方法 | 熊市 | 基准 | 牛市 |
|------|---------|------|------|------|
| {业务1} | {PE/EV-S} | ${X}B | ${Y}B | ${Z}B |
| ... | ... | ... | ... | ... |
| **总计** | | ${bear}B | ${base}B | ${bull}B |

**概率加权目标价**: ${weighted_price}

### 6.3 敏感性分析

| 变量 | 基准假设 | -20% | +20% | 股价影响 |
|------|---------|------|------|---------|
| {变量1} | {基准} | ${X} | ${Y} | {高/中/低} |

**最敏感变量**: {变量名}

### 6.4 与市场共识对比

| 来源 | 目标价 |
|------|--------|
| 本报告 | ${my_price} |
| 华尔街共识 | ${consensus} |

**我与共识差异**: {X}%
**差异解释**: {原因}

### 6.5 投资建议

**评级**: {Buy/Hold/Sell}
**目标价**: ${X}-${Y}
**上行空间**: {X}%
**下行风险**: {Y}%
**风险收益比**: {ratio}
**关键监控**: {变量}
**Kill Switch**: {条件}

---

## 第七部分：创新方法尝试

### 方法1: {方法名}
{过程和结果}

### 方法2: {方法名}
{过程和结果}

### 方法3: {方法名}
{过程和结果}

---

## 深度指数自测

| 维度 | 权重 | 得分 | 加权分 |
|------|------|------|--------|
| D1 第一性原理 | 15% | {score}/10 | {weighted} |
| D2 护城河深度 | 15% | {score}/10 | {weighted} |
| D3 产品矩阵 | 10% | {score}/10 | {weighted} |
| D4 竞争格局 | 10% | {score}/10 | {weighted} |
| D5 分析师超越 | 10% | {score}/10 | {weighted} |
| D6 创新方法 | 10% | {score}/10 | {weighted} |
| D7 跨域类比 | 10% | {score}/10 | {weighted} |
| D8 反常识洞察 | 10% | {score}/10 | {weighted} |
| D9 数据溯源 | 5% | {score}/10 | {weighted} |
| D10 估值逻辑 | 5% | {score}/10 | {weighted} |
| **总计** | 100% | - | **DI = {total}** |

**评级**: {优秀/合格/不合格}
**薄弱维度**: {列出得分<7的维度}

---

## 质量检查结果

| 检查项 | 状态 | 详情 |
|--------|------|------|
| 搜索平衡 | {✅/⚠️} | 威胁{X} vs 优势{Y} |
| 论点平衡 | {✅/⚠️} | 做空{X} vs 做多{Y} |
| 用户声音 | {✅/⚠️} | 正面{X} vs 负面{Y} |
| 期权估值 | {✅/⚠️} | {完成/不适用} |
| 隐藏痕迹 | {✅/⚠️} | {X}种尝试 |
| 分析师解构 | {✅/⚠️} | {X}位分析师 |
| 技术架构 | {✅/⚠️} | {完成/不适用} |
| 估值完整性 | {✅/⚠️} | 反推+SOTP+敏感性+共识 |
| 时效性 | {✅/⚠️} | 最新{日期} |

---

*报告版本: v1.3*
*方法框架: Deep Cognition Skill v1.3*
```

---

## 自动选择逻辑

### v1.1 新增：公司类型→优势维度映射

```yaml
company_type_advantage_mapping:
  # 不同类型的公司，需要重点分析的优势维度不同
  # 这是"范化"的核心：根据公司类型自动调整分析重点

  科技平台公司:
    示例: [Google, Meta, Amazon, Microsoft]
    必须分析的优势维度:
      - 数据优势: "独占数据资产的规模和排他性"
      - 生态系统: "产品间的数据/技术/分发协同"
      - AI基础设施: "算力成本优势（自研芯片、数据中心效率）"
      - 分发渠道: "触达用户的能力和成本"
    容易遗漏的点:
      - "自研芯片的成本优势往往被低估"
      - "训练数据的独占性是真正的护城河"
      - "B端云业务和C端产品的协同"

  消费品牌公司:
    示例: [Apple, Nike, LVMH, Starbucks]
    必须分析的优势维度:
      - 品牌溢价: "能收取多少溢价？溢价来源？"
      - 定价权: "提价能力和历史提价幅度"
      - 用户忠诚度: "复购率、NPS、生态锁定"
      - 渠道控制: "直销vs分销，渠道利润分配"
    容易遗漏的点:
      - "服务收入的粘性往往高于硬件"
      - "品牌在新兴市场的渗透空间"

  半导体/硬科技公司:
    示例: [NVIDIA, ASML, LRCX, TSMC]
    必须分析的优势维度:
      - 技术领先度: "技术代差有多大？追赶需要多久？"
      - 客户锁定: "转换成本、认证周期、供应商集中度"
      - 产能优势: "资本开支规模、产能扩张能力"
      - 周期位置: "当前处于周期什么位置？"
    容易遗漏的点:
      - "下游客户的资本开支计划"
      - "地缘政治对供应链的影响"

  金融服务公司:
    示例: [JPM, Visa, Berkshire, BlackRock]
    必须分析的优势维度:
      - 资金成本: "融资成本优势"
      - 规模效应: "固定成本摊薄"
      - 网络效应: "交易网络的价值"
      - 监管壁垒: "牌照价值和合规成本"
    容易遗漏的点:
      - "交叉销售能力"
      - "资产负债久期匹配"

  周期性工业公司:
    示例: [CAT, DE, 航运公司, 大宗商品]
    必须分析的优势维度:
      - 成本曲线位置: "在行业成本曲线的位置"
      - 资产负债表强度: "能否熬过周期底部"
      - 资本配置: "周期管理能力（低买高卖资产）"
      - 替代品价格: "什么价格会触发需求替代"
    容易遗漏的点:
      - "库存周期 vs 资本开支周期"
      - "边际生产商的现金成本"
```

### 跨域类比领域自动选择

```yaml
company_type_detection:

  成熟平台公司:
    特征:
      - 市场份额稳定
      - 增速放缓
      - 生态系统成熟
    示例: [Apple, Microsoft, Salesforce]
    最佳类比领域: 生物学-生态系统

  技术转型公司:
    特征:
      - 核心业务面临颠覆
      - AI/新技术冲击
      - 估值与增速不匹配
    示例: [Google, Intel, IBM]
    最佳类比领域: 物理学-相变

  多业务耦合公司:
    特征:
      - 多个业务线互相支撑
      - 协同效应明显
      - 单独估值困难
    示例: [Amazon, Alibaba, Tencent]
    最佳类比领域: 系统动力学-飞轮

  周期性公司:
    特征:
      - 收入/利润周期波动大
      - 与宏观经济相关
      - 历史重复模式
    示例: [半导体设备, 航运, 大宗商品]
    最佳类比领域: 历史模式-周期

  颠覆者:
    特征:
      - 挑战现有格局
      - 商业模式创新
      - 高增长高风险
    示例: [Tesla, SpaceX, Palantir]
    最佳类比领域: TRIZ原理
```

### 方法权重自动调整

```yaml
weight_adjustment_rules:

  # 基于公司特征调整
  if 核心业务有矛盾:
    矛盾引爆.weight += 10%

  if 多业务公司:
    跨域类比.weight += 5%
    梯度聚焦.weight += 5%

  if 面临重大风险:
    反事实模拟.weight += 10%
    边界探测.weight += 5%

  if 估值有争议:
    对抗测试.weight += 10%

  if 信息不透明:
    负空间扫描.weight += 10%
```

---

## v1.1 新增：平衡检查机制

### 输出前强制平衡检查

```yaml
balance_check:
  执行时机: 在输出报告前自动执行
  设计原理: |
    v1.0问题：分析偏向风险，遗漏优势，导致过度悲观
    v1.1修复：强制平衡检查，确保多空视角均衡

  检查项目:

    搜索平衡检查:
      规则: 优势搜索结果数量 >= 威胁搜索结果数量 × 0.5
      失败处理: 补充优势搜索直到达标
      输出: "搜索平衡: 威胁{X}条 vs 优势{Y}条 → {通过/需补充}"

    论点平衡检查:
      规则: 报告中做多论点数量 >= 做空论点数量 × 0.7
      失败处理: 补充做多论点分析
      输出: "论点平衡: 做空{X}条 vs 做多{Y}条 → {通过/需补充}"

    优势覆盖检查:
      规则: 至少覆盖3个优势类型（成本/技术/数据/分发/生态）
      失败处理: 补充缺失的优势类型分析
      输出: "优势覆盖: {已覆盖类型列表} → {通过/需补充}"

    生态系统检查:
      规则: 生态系统分析图已完成，包含数据流+技术栈+独占资源
      失败处理: 补充生态系统分析
      输出: "生态系统分析: {完整/缺失X}"

    时效性检查:
      规则: 报告包含过去30天内的最新信息
      失败处理: 补充最新搜索
      输出: "时效性: 最新数据{日期} → {通过/过期}"

  输出格式: |
    ## 平衡检查结果（v1.1）

    | 检查项 | 状态 | 详情 |
    |--------|------|------|
    | 搜索平衡 | {✅/⚠️} | 威胁{X} vs 优势{Y} |
    | 论点平衡 | {✅/⚠️} | 做空{X} vs 做多{Y} |
    | 优势覆盖 | {✅/⚠️} | {已覆盖类型} |
    | 生态系统 | {✅/⚠️} | {完整/缺失} |
    | 时效性 | {✅/⚠️} | 最新{日期} |

    ⚠️ 任一检查未通过 = 报告偏见风险，需补充
```

---

## 防偷懒机制

### 断言检查（v1.3更新）

```python
# 在报告输出前自动执行

# === v1.0 原有断言 ===
assert first_principles_answered == True, "必须完成第一性原理三问"
assert len(first_principles_q1) >= 300, "Q1回答必须≥300字"
assert len(first_principles_q2) >= 300, "Q2回答必须≥300字"
assert len(first_principles_q3) >= 300, "Q3回答必须≥300字"
assert moat_7powers_verified == True, "必须完成7 Powers验证"
assert innovation_attempts >= 3, "必须尝试≥3种创新方法"
assert depth_index >= 70, "DI必须≥70才能输出"

# === v1.1 新增断言 ===
assert balanced_search_completed == True, "必须完成双向搜索（威胁+优势+时效性）"
assert advantage_search_count >= threat_search_count * 0.5, "优势搜索不能太少"
assert advantage_list_completed == True, "必须输出优势清单（5个维度）"
assert ecosystem_analysis_completed == True, "必须完成生态系统分析"
assert bull_case_presented == True, "必须有做多论点（不能只有做空）"
assert recency_check_passed == True, "必须包含近30天最新信息"
assert balance_check_passed == True, "必须通过平衡检查"

# === v1.2 新增断言 ===
assert user_voice_positive_count >= 5, "必须搜索≥5条正面用户声音"
assert user_voice_negative_count >= 5, "必须搜索≥5条负面用户声音"

# === v1.3 新增断言 ===
assert option_business_identified == True, "必须识别期权业务（即使没有也要说明）"
assert option_valuation_completed == True or no_option_business, "有期权业务必须估值"
assert hidden_traces_attempts >= 3, "必须尝试≥3种隐藏痕迹挖掘"
assert analyst_frameworks_deconstructed >= 3, "必须解构≥3位分析师框架"
assert analyst_blind_spots_found >= 1, "必须找到≥1个分析师盲区"
assert tech_architecture_analyzed == True if is_tech_company else True, "科技公司必须分析技术架构"
assert reverse_valuation_completed == True, "必须完成反推估值"
assert sotp_valuation_completed == True, "必须完成SOTP估值"
assert sensitivity_analysis_completed == True, "必须完成敏感性分析"
assert consensus_comparison_completed == True, "必须与市场共识对比"
```

### 强制顺序（v1.3更新）

```
Phase 0a: 双向搜索（威胁+优势+时效性+用户声音）
Phase 0b: 第一性原理三问
Phase 0c: 优势清单+生态系统分析
Phase 1: 护城河(7 Powers)+压缩+矛盾
Phase 2: 梯度+负空间+双向对抗
Phase 3: 跨域+反事实+双向边界
Phase 4: 不变量+元递归
Phase 5: 数据收集+API调用 → 注意：这是第5步，不是第1步
Phase 6: v1.3新增模块
  6a: 期权业务识别与估值
  6b: 隐藏痕迹挖掘（≥3种）
  6c: 分析师框架解构（≥3位）
  6d: 技术架构深挖（科技公司）
Phase 7: 创新方法尝试
Phase 8: 估值体系（反推+SOTP+期权+敏感性+共识对比）
Phase 9: 平衡检查
Phase 10: Depth Index自测 → DI<70必须返工
```

### 随机抽查问题

```yaml
random_depth_checks:
  触发: 分析过程中随机触发
  问题池:
    - "你刚才说的这个结论，反面证据是什么？"
    - "如果这个假设错了，会怎样？"
    - "有没有竞争对手做得更好？为什么？"
    - "这个数据来源是什么？"
    - "顶级分析师会怎么反驳你？"
    - "这个结论能用一句话说清吗？"
    - "什么信息能让你改变这个结论？"
```

---

## 版本历史

```yaml
version_history:
  - version: "1.3.0"
    date: "2026-01-28"
    trigger: "Google v2分析反馈：期权分析遗漏、隐藏痕迹挖掘能力消失、分析师学习流于形式、技术架构太浅、估值分析不够"
    root_cause: |
      1. Tesla分析中的期权估值方法没有固化为强制模块
      2. 隐藏痕迹挖掘（如充电桩数据）只是临时尝试，没有按公司类型模板化
      3. 分析师学习只罗列观点，没有强制"解构框架+找盲区+超越"
      4. 科技公司技术架构分析没有分层强制要求
      5. 估值只用一种方法，缺少反推、敏感性、期权、共识对比
    changes:
      - "新增模块1: 期权业务识别与估值（强制识别彩票型业务）"
      - "新增模块2: 隐藏痕迹挖掘（按公司类型→痕迹类型映射）"
      - "新增模块3: 分析师框架解构（强制4问+超越点识别）"
      - "新增模块4: 技术架构深挖（4层技术栈+壁垒量化）"
      - "新增模块5: 估值体系升级（反推+SOTP+期权+敏感性+共识）"
      - "新增断言: 10条v1.3强制检查"
      - "更新强制顺序: Phase 6拆分为4个子阶段"
    key_insight: |
      能力衰减的根本原因：
      1. 一次性创新没有固化为强制模块
      2. 公司特定的方法没有抽象为类型通用模板
      3. 没有断言强制执行，导致"可做可不做"变成"不做"

      解决方案：
      1. 每个有价值的方法都变成强制模块
      2. 每个模块都有assert检查
      3. 每个模块都有公司类型→执行模板的映射
    tested_on: ["Tesla", "Apple", "Google", "Amazon"]

  - version: "1.2.0"
    date: "2026-01-28"
    trigger: "用户反馈：AI无法线下调研，但可以通过大量搜索用户声音来弥补"
    root_cause: "缺少用户真实反馈的系统性收集，导致分析缺乏'感知力'"
    changes:
      - "新增: user_voice_searches 用户声音挖掘模块"
      - "正面搜索: product review amazing best reddit"
      - "负面搜索: problems issues frustrating disappointed"
      - "细节搜索: hidden feature underrated tip"
      - "社区情绪: reddit twitter hacker news sentiment"
      - "输出格式: 用户声音拼图表格"
    key_insight: |
      AI虽然无法线下调研，但可以：
      1. 搜索海量用户评论（Reddit/Twitter/HN/专业论坛）
      2. 拼接这些"声音碎片"构建产品真实画像
      3. 这种能力可以超越人类（人类不可能读完那么多评论）
      4. 用户声音揭示的优劣势往往比分析师报告更真实

  - version: "1.1.0"
    date: "2026-01-28"
    trigger: "Google分析遗漏TPU优势、Gemini 3.0口碑、YouTube数据护城河等关键信息"
    root_cause: "搜索偏向威胁、认知方法偏悲观、缺少生态系统视角"
    changes:
      - "新增: phase_0_balanced_search 双向搜索（威胁+优势+时效性）"
      - "新增: phase_0_advantage_list 强制优势清单输出"
      - "新增: phase_0_ecosystem_analysis 生态系统分析（替代简单产品矩阵）"
      - "升级: step_5_对抗测试 → 双向对抗（做空+做多论点）"
      - "升级: step_8_边界探测 → 双向边界（失效条件+加深条件）"
      - "新增: company_type_advantage_mapping 公司类型→优势维度映射"
      - "新增: balance_check 平衡检查机制"
    generalization_principle: |
      经验固化不是靠"大量训练"，而是靠：
      1. 结构化流程：把"应该做什么"变成"必须做的检查点"
      2. 模式库：把"特定公司的教训"抽象成"公司类型→分析模板"
      3. 防偏见机制：强制平衡检查，而不是事后发现偏差

  - version: "1.0.0"
    date: "2026-01-28"
    changes:
      - "初始版本"
      - "三层结构: scan/analyze/deep"
      - "10种核心认知方法"
      - "实战测试验证: Apple, Google, Amazon"
      - "自动领域选择逻辑"
      - "防偷懒机制"
      - "Depth Index集成"
```

---

## 使用示例

```
用户: /scan AAPL
→ 执行Layer 0，输出5分钟快速扫描

用户: /analyze GOOGL
→ 执行Layer 1，输出30分钟标准分析

用户: /deep AMZN
→ 执行Layer 2，输出2小时深度报告
```
