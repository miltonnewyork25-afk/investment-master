# Lessons Learned Knowledge Base
# 累积的经验教训存储

version: "1.0"
last_updated: "2026-01-27"

lessons:
  - id: "LL_001"
    date: "2026-01-27"
    context: "Tesla v11.0 分析"
    category: "agent_execution"
    lesson: "Innovation Agent Pipeline被提及但未真正执行完整流程"
    root_cause: "缺少强制执行器skill，Pipeline各阶段没有checkpoint验证"
    action_taken: "创建 innovation_pipeline_executor_v1.skill.md"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_002"
    date: "2026-01-27"
    context: "Tesla v11.0 分析"
    category: "api_integration"
    lesson: "FMP analyst-estimates API需要period参数(annual/quarter)"
    root_cause: "data_source_registry中未明确说明必需参数"
    action_taken: "更新data_source_registry添加period参数说明"
    effectiveness: "已验证"
    priority: "P1"

  - id: "LL_003"
    date: "2026-01-27"
    context: "Tesla v11.0 分析"
    category: "framework_design"
    lesson: "7个Agent的输出是单体混合的，缺少结构化分离"
    root_cause: "没有强制要求每个Agent产出独立的YAML/JSON块"
    action_taken: "在analysis_preloader中添加Agent输出格式强制要求"
    effectiveness: "待验证"
    priority: "P1"

  - id: "LL_004"
    date: "2026-01-27"
    context: "Tesla v11.0 分析"
    category: "automation"
    lesson: "没有自动反思机制，需要用户手动触发"
    root_cause: "缺少post-analysis skill"
    action_taken: "创建 post_analysis_reflection_v1.skill.md 和 compound_learning_v1.skill.md"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_005"
    date: "2026-01-27"
    context: "Tesla v11.0 分析"
    category: "tool_integration"
    lesson: "Ralph Loop插件有bug无法启动"
    root_cause: "setup-ralph-loop.sh脚本中PROMPT_PARTS变量未绑定"
    action_taken: "记录问题，等待插件更新"
    effectiveness: "N/A - 外部依赖"
    priority: "P2"

  - id: "LL_006"
    date: "2026-01-27"
    context: "Tesla v11.0 分析"
    category: "data_quality"
    lesson: "应收账款增速(+42%)显著高于收入增速(+12%)的异常未深挖"
    root_cause: "盈利质量警示被标注但未追溯具体原因"
    action_taken: "在quality_checklist中添加'异常指标必须追溯原因'要求"
    effectiveness: "待验证"
    priority: "P1"

  - id: "LL_007"
    date: "2026-01-27"
    context: "LRCX v1.0 分析"
    category: "data_traceability"
    lesson: "报告中数字来源不清晰（API vs 估算 vs 分析师预测混在一起）"
    root_cause: "缺少数据来源强制标注机制"
    action_taken: "在CLAUDE.md中添加数据分层标注要求"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_008"
    date: "2026-01-27"
    context: "LRCX v1.0 分析"
    category: "api_utilization"
    lesson: "100baggers API返回的7维度雷达图评分未在报告中展示"
    root_cause: "API数据获取后未强制融入报告结构"
    action_taken: "添加API数据展示强制清单"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_009"
    date: "2026-01-27"
    context: "LRCX v1.0 分析"
    category: "valuation_logic"
    lesson: "SOTP概率加权目标价($161)与最终评级目标价($250-280)存在逻辑断层"
    root_cause: "主观情绪调整缺乏量化支撑，终端目标价反而依赖市场共识而非自己的模型"
    action_taken: "估值必须以自己的SOTP为锚，与市场共识差距>30%必须详细解释"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_010"
    date: "2026-01-27"
    context: "LRCX v1.0 分析"
    category: "quality_gate"
    lesson: "质量门控声称'通过'但未显式执行每个检查项"
    root_cause: "质量门控是文档而非强制流程"
    action_taken: "报告末尾必须附上Quality Gate执行结果表"
    effectiveness: "待验证"
    priority: "P1"

  - id: "LL_011"
    date: "2026-01-27"
    context: "用户反馈"
    category: "data_quality"
    lesson: "100baggers API的7维度雷达图评分过于主观，权重算法不透明，可能误导判断"
    root_cause: "评分基于主观权重，缺乏可解释性和可验证性"
    action_taken: "禁用7维度评分，仅使用客观数据（杜邦分解、ROIC、领先指标触发）"
    effectiveness: "已生效"
    priority: "P0"

  - id: "LL_012"
    date: "2026-01-27"
    context: "AAPL v1.0 分析"
    category: "workflow_optimization"
    lesson: "并行调用多个API和搜索可以显著提升效率"
    root_cause: "之前是串行执行，浪费时间"
    action_taken: "确认并行执行模式作为标准流程"
    effectiveness: "已验证"
    priority: "P1"

  - id: "LL_013"
    date: "2026-01-27"
    context: "AAPL v1.0 分析"
    category: "quality_control"
    lesson: "质量门控显式执行+报告末尾附结果表的模式有效"
    root_cause: "之前门控是隐式的，难以验证"
    action_taken: "将此模式固化为标准流程"
    effectiveness: "已验证"
    priority: "P1"

  - id: "LL_014"
    date: "2026-01-27"
    context: "AAPL v1.0 分析"
    category: "valuation_discipline"
    lesson: "铁律4（SOTP为锚）有效防止了估值逻辑断层"
    root_cause: "LRCX分析中SOTP$161 vs 目标价$250-280差距过大"
    action_taken: "AAPL分析中SOTP$267 vs 目标价$270-290差距5%，逻辑自洽"
    effectiveness: "已验证"
    priority: "P0"

  - id: "LL_015"
    date: "2026-01-28"
    context: "AAPL v1.0 用户反馈"
    category: "system_architecture"
    lesson: "经验无法沉淀的根本原因：lessons_learned是静态记录，不是强制执行机制"
    root_cause: "定义了'什么是深度'，但没有强制'如何产生深度'的过程控制"
    action_taken: "创建deep_thinking_protocol_v1.md，强制在数据收集前完成第一性原理思考"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_016"
    date: "2026-01-28"
    context: "AAPL v1.0 用户反馈"
    category: "depth_failure"
    lesson: "AAPL报告只有数据罗列，缺少：护城河分析、产品矩阵、竞争格局、第一性原理"
    root_cause: "深度思考不是事后检查能保证的，必须是过程强制"
    action_taken: "深度思考协议设为工作流第一步，在API调用之前执行"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_017"
    date: "2026-01-28"
    context: "AAPL v1.0 用户反馈"
    lesson: "分析师学习流于形式：只罗列观点，没有解构框架、找盲区、超越"
    root_cause: "没有强制要求'理解框架+找盲区+超越'"
    action_taken: "协议要求：每个分析师必须回答4个问题（框架、假设、失效条件、盲区）"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_018"
    date: "2026-01-28"
    context: "AAPL v1.0 用户反馈"
    category: "innovation_failure"
    lesson: "AAPL报告毫无创新尝试，Tesla报告中的创新方法（充电桩、期权估值）完全消失"
    root_cause: "没有强制要求创新尝试"
    action_taken: "协议要求：必须尝试至少3种非常规分析方法，即使失败也要记录"
    effectiveness: "待验证"
    priority: "P0"

# 统计
statistics:
  total_lessons: 18
  by_category:
    agent_execution: 1
    api_integration: 1
    api_utilization: 1
    framework_design: 1
    automation: 1
    tool_integration: 1
    data_quality: 1
    data_traceability: 1
    valuation_logic: 1
    quality_gate: 1
  by_priority:
    P0: 5
    P1: 4
    P2: 1
  resolved: 1
  pending: 9
