# Lessons Learned Knowledge Base
# 累积的经验教训存储

version: "1.0"
last_updated: "2026-01-27"

lessons:
  - id: "LL_001"
    date: "2026-01-27"
    context: "Tesla v11.0 分析"
    category: "agent_execution"
    lesson: "Innovation Agent Pipeline被提及但未真正执行完整流程"
    root_cause: "缺少强制执行器skill，Pipeline各阶段没有checkpoint验证"
    action_taken: "创建 innovation_pipeline_executor_v1.skill.md"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_002"
    date: "2026-01-27"
    context: "Tesla v11.0 分析"
    category: "api_integration"
    lesson: "FMP analyst-estimates API需要period参数(annual/quarter)"
    root_cause: "data_source_registry中未明确说明必需参数"
    action_taken: "更新data_source_registry添加period参数说明"
    effectiveness: "已验证"
    priority: "P1"

  - id: "LL_003"
    date: "2026-01-27"
    context: "Tesla v11.0 分析"
    category: "framework_design"
    lesson: "7个Agent的输出是单体混合的，缺少结构化分离"
    root_cause: "没有强制要求每个Agent产出独立的YAML/JSON块"
    action_taken: "在analysis_preloader中添加Agent输出格式强制要求"
    effectiveness: "待验证"
    priority: "P1"

  - id: "LL_004"
    date: "2026-01-27"
    context: "Tesla v11.0 分析"
    category: "automation"
    lesson: "没有自动反思机制，需要用户手动触发"
    root_cause: "缺少post-analysis skill"
    action_taken: "创建 post_analysis_reflection_v1.skill.md 和 compound_learning_v1.skill.md"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_005"
    date: "2026-01-27"
    context: "Tesla v11.0 分析"
    category: "tool_integration"
    lesson: "Ralph Loop插件有bug无法启动"
    root_cause: "setup-ralph-loop.sh脚本中PROMPT_PARTS变量未绑定"
    action_taken: "记录问题，等待插件更新"
    effectiveness: "N/A - 外部依赖"
    priority: "P2"

  - id: "LL_006"
    date: "2026-01-27"
    context: "Tesla v11.0 分析"
    category: "data_quality"
    lesson: "应收账款增速(+42%)显著高于收入增速(+12%)的异常未深挖"
    root_cause: "盈利质量警示被标注但未追溯具体原因"
    action_taken: "在quality_checklist中添加'异常指标必须追溯原因'要求"
    effectiveness: "待验证"
    priority: "P1"

  - id: "LL_007"
    date: "2026-01-27"
    context: "LRCX v1.0 分析"
    category: "data_traceability"
    lesson: "报告中数字来源不清晰（API vs 估算 vs 分析师预测混在一起）"
    root_cause: "缺少数据来源强制标注机制"
    action_taken: "在CLAUDE.md中添加数据分层标注要求"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_008"
    date: "2026-01-27"
    context: "LRCX v1.0 分析"
    category: "api_utilization"
    lesson: "100baggers API返回的7维度雷达图评分未在报告中展示"
    root_cause: "API数据获取后未强制融入报告结构"
    action_taken: "添加API数据展示强制清单"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_009"
    date: "2026-01-27"
    context: "LRCX v1.0 分析"
    category: "valuation_logic"
    lesson: "SOTP概率加权目标价($161)与最终评级目标价($250-280)存在逻辑断层"
    root_cause: "主观情绪调整缺乏量化支撑，终端目标价反而依赖市场共识而非自己的模型"
    action_taken: "估值必须以自己的SOTP为锚，与市场共识差距>30%必须详细解释"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_010"
    date: "2026-01-27"
    context: "LRCX v1.0 分析"
    category: "quality_gate"
    lesson: "质量门控声称'通过'但未显式执行每个检查项"
    root_cause: "质量门控是文档而非强制流程"
    action_taken: "报告末尾必须附上Quality Gate执行结果表"
    effectiveness: "待验证"
    priority: "P1"

  - id: "LL_011"
    date: "2026-01-27"
    context: "用户反馈"
    category: "data_quality"
    lesson: "100baggers API的7维度雷达图评分过于主观，权重算法不透明，可能误导判断"
    root_cause: "评分基于主观权重，缺乏可解释性和可验证性"
    action_taken: "禁用7维度评分，仅使用客观数据（杜邦分解、ROIC、领先指标触发）"
    effectiveness: "已生效"
    priority: "P0"

  - id: "LL_012"
    date: "2026-01-27"
    context: "AAPL v1.0 分析"
    category: "workflow_optimization"
    lesson: "并行调用多个API和搜索可以显著提升效率"
    root_cause: "之前是串行执行，浪费时间"
    action_taken: "确认并行执行模式作为标准流程"
    effectiveness: "已验证"
    priority: "P1"

  - id: "LL_013"
    date: "2026-01-27"
    context: "AAPL v1.0 分析"
    category: "quality_control"
    lesson: "质量门控显式执行+报告末尾附结果表的模式有效"
    root_cause: "之前门控是隐式的，难以验证"
    action_taken: "将此模式固化为标准流程"
    effectiveness: "已验证"
    priority: "P1"

  - id: "LL_014"
    date: "2026-01-27"
    context: "AAPL v1.0 分析"
    category: "valuation_discipline"
    lesson: "铁律4（SOTP为锚）有效防止了估值逻辑断层"
    root_cause: "LRCX分析中SOTP$161 vs 目标价$250-280差距过大"
    action_taken: "AAPL分析中SOTP$267 vs 目标价$270-290差距5%，逻辑自洽"
    effectiveness: "已验证"
    priority: "P0"

  - id: "LL_015"
    date: "2026-01-28"
    context: "AAPL v1.0 用户反馈"
    category: "system_architecture"
    lesson: "经验无法沉淀的根本原因：lessons_learned是静态记录，不是强制执行机制"
    root_cause: "定义了'什么是深度'，但没有强制'如何产生深度'的过程控制"
    action_taken: "创建deep_thinking_protocol_v1.md，强制在数据收集前完成第一性原理思考"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_016"
    date: "2026-01-28"
    context: "AAPL v1.0 用户反馈"
    category: "depth_failure"
    lesson: "AAPL报告只有数据罗列，缺少：护城河分析、产品矩阵、竞争格局、第一性原理"
    root_cause: "深度思考不是事后检查能保证的，必须是过程强制"
    action_taken: "深度思考协议设为工作流第一步，在API调用之前执行"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_017"
    date: "2026-01-28"
    context: "AAPL v1.0 用户反馈"
    lesson: "分析师学习流于形式：只罗列观点，没有解构框架、找盲区、超越"
    root_cause: "没有强制要求'理解框架+找盲区+超越'"
    action_taken: "协议要求：每个分析师必须回答4个问题（框架、假设、失效条件、盲区）"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_018"
    date: "2026-01-28"
    context: "AAPL v1.0 用户反馈"
    category: "innovation_failure"
    lesson: "AAPL报告毫无创新尝试，Tesla报告中的创新方法（充电桩、期权估值）完全消失"
    root_cause: "没有强制要求创新尝试"
    action_taken: "协议要求：必须尝试至少3种非常规分析方法，即使失败也要记录"
    effectiveness: "待验证"
    priority: "P0"

  - id: "LL_020"
    date: "2026-01-28"
    context: "Google深度分析"
    category: "analysis_bias"
    lesson: "分析严重偏向威胁/风险，遗漏Google的关键优势（TPU成本优势、Gemini 3.0口碑、YouTube数据护城河、DeepMind研发能力、产品生态协同）"
    root_cause: |
      1. 搜索查询偏向威胁（只搜risk/threat/competition，不搜advantage/moat）
      2. 认知方法偏悲观（对抗测试只做空、边界探测只找失效条件、负空间只找坏消息）
      3. 产品矩阵只看收入占比，不看技术/数据/分发协同
      4. 缺少时效性搜索，错过Gemini 3.0最新口碑和Apple合作
    action_taken: |
      升级Deep Cognition Skill到v1.1：
      - 新增双向搜索（威胁+优势+时效性）
      - 新增强制优势清单（5个维度）
      - 新增生态系统分析（替代简单产品矩阵）
      - 升级对抗测试为双向（做空+做多论点）
      - 升级边界探测为双向（失效条件+加深条件）
      - 新增公司类型→优势维度映射
      - 新增平衡检查机制
    effectiveness: "待验证"
    priority: "P0"
    generalization_insight: |
      经验固化不需要"大量训练"，而是需要：
      1. 结构化流程：把教训变成强制检查点
      2. 模式库：把特定公司教训抽象成"公司类型→分析模板"
      3. 防偏见机制：输出前强制平衡检查

  - id: "LL_019"
    date: "2026-01-28"
    context: "Deep Cognition Skill开发"
    category: "methodology_breakthrough"
    lesson: "10种AI原生认知方法经Apple/Google/Amazon实战验证有效"
    root_cause: "通过对话探索发现AI可以使用非自然语言的思维模式"
    action_taken: "创建deep_cognition_v1.skill.md，整合10种方法+三层触发+自动选择"
    effectiveness: "待大规模验证"
    priority: "P0"
    details:
      methods_tested:
        - name: "压缩挑战"
          effectiveness: "⭐⭐⭐⭐⭐ 5/5"
          weight: "8-15%"
        - name: "矛盾引爆"
          effectiveness: "⭐⭐⭐⭐⭐ 5/5"
          weight: "12-20%"
        - name: "梯度聚焦"
          effectiveness: "⭐⭐⭐⭐⭐ 5/5"
          weight: "12-20%"
        - name: "负空间扫描"
          effectiveness: "⭐⭐⭐⭐ 4/5"
          weight: "10-15%"
        - name: "对抗测试"
          effectiveness: "⭐⭐⭐⭐⭐ 5/5"
          weight: "10-15%"
        - name: "跨域类比"
          effectiveness: "⭐⭐⭐⭐ 4/5"
          weight: "10-15%"
        - name: "反事实模拟"
          effectiveness: "⭐⭐⭐⭐ 4/5"
          weight: "10%"
        - name: "边界探测"
          effectiveness: "⭐⭐⭐ 3/5"
          weight: "8%"
        - name: "不变量搜索"
          effectiveness: "⭐⭐⭐ 3/5"
          weight: "5%"
        - name: "元递归"
          effectiveness: "⭐⭐⭐ 3/5"
          weight: "5%"
      trigger_commands:
        - "/scan {ticker} → 5分钟，3种方法"
        - "/analyze {ticker} → 30分钟，6种方法"
        - "/deep {ticker} → 2小时，10种方法+前后置"

  - id: "LL_021"
    date: "2026-01-28"
    context: "Google v2分析 + Deep Cognition Skill v1.3升级"
    category: "skill_generalization"
    lesson: "能力衰减的根本原因是'一次性创新没有固化为强制模块'"
    root_cause: |
      1. Tesla分析中的期权估值方法只是临时尝试，没有变成强制模块
      2. 隐藏痕迹挖掘（充电桩数据）没有按公司类型模板化
      3. 分析师学习只罗列观点，没有强制"解构+找盲区+超越"
      4. 估值只用单一方法，缺少反推、敏感性、共识对比
    action_taken: |
      升级Deep Cognition Skill到v1.3，新增5个强制模块：
      1. 期权业务识别与估值（强制识别彩票型业务）
      2. 隐藏痕迹挖掘（按公司类型→痕迹类型映射）
      3. 分析师框架解构（强制4问+超越点识别）
      4. 技术架构深挖（4层技术栈+壁垒量化，科技公司强制）
      5. 估值体系升级（反推+SOTP+期权+敏感性+共识对比）
      每个模块都有断言检查，缺失即报告不合格
    effectiveness: "待验证"
    priority: "P0"
    generalization_principle: |
      防止能力衰减的三层机制：
      1. 结构化模块：每个有价值的方法都变成强制模块
      2. 类型化模板：每个模块都有公司类型→执行模板的映射
      3. 断言强制：每个模块都有assert检查，不能"可做可不做"

# 统计
statistics:
  total_lessons: 21
  by_category:
    agent_execution: 1
    api_integration: 1
    api_utilization: 1
    framework_design: 1
    automation: 1
    tool_integration: 1
    data_quality: 1
    data_traceability: 1
    valuation_logic: 1
    quality_gate: 1
    methodology_breakthrough: 1
    analysis_bias: 1  # v1.1 新增
    skill_generalization: 1  # v1.3 新增
  by_priority:
    P0: 8
    P1: 4
    P2: 1
  resolved: 1
  pending: 12
